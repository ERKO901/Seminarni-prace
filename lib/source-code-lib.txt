================================================================================
SOURCE CODE COLLECTION
Generated: 2025-12-05 22:18:01
Project: lib
Path: /home/erko/IdeaProjects/magistri/lib
Files collected: 15
================================================================================

PROJECT STRUCTURE:
----------------------------------------
lib/
  main.dart
  models/
    data_models.dart
    user_model.dart
  screens/
    dashboard_screen.dart
    grades_screen.dart
    login_screen.dart
    teacher_class_detail_screen.dart
    teacher_classes_screen.dart
    teacher_grade_types_screen.dart
    teacher_students_grades_screen.dart
    teacher_subject_classes_screen.dart
    teacher_timetable_screen.dart
    timetable_screen.dart
  services/
    data_service.dart
  theme/
    app_theme.dart

================================================================================

SOURCE CODE FILES:
================================================================================

File: main.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import 'package:flutter/services.dart';
import 'screens/login_screen.dart';
import 'screens/dashboard_screen.dart';
import 'theme/app_theme.dart';
import 'models/user_model.dart';
import 'services/data_service.dart';

void main() {
  WidgetsFlutterBinding.ensureInitialized();

  SystemChrome.setSystemUIOverlayStyle(const SystemUiOverlayStyle(
    statusBarColor: Colors.transparent,
    systemNavigationBarColor: Colors.transparent,
    statusBarIconBrightness: Brightness.light,
    systemNavigationBarIconBrightness: Brightness.light,
  ));

  runApp(const MagistryApp());
}

class MagistryApp extends StatefulWidget {
  const MagistryApp({super.key});

  @override
  State<MagistryApp> createState() => _MagistryAppState();
}

class _MagistryAppState extends State<MagistryApp> with WidgetsBindingObserver {
  ThemeMode _themeMode = ThemeMode.dark;
  UserType? _userType;
  late bool _systemIsDark;
  final DataService _dataService = DataService();

  @override
  void initState() {
    super.initState();
    WidgetsBinding.instance.addObserver(this);
    _systemIsDark =
        WidgetsBinding.instance.platformDispatcher.platformBrightness ==
            Brightness.dark;
  }

  @override
  void dispose() {
    WidgetsBinding.instance.removeObserver(this);
    super.dispose();
  }

  @override
  void didChangePlatformBrightness() {
    setState(() {
      _systemIsDark =
          WidgetsBinding.instance.platformDispatcher.platformBrightness ==
              Brightness.dark;
    });
  }

  bool get _effectiveIsDark {
    switch (_themeMode) {
      case ThemeMode.system:
        return _systemIsDark;
      case ThemeMode.light:
        return false;
      case ThemeMode.dark:
        return true;
    }
  }

  void _cycleTheme() {
    setState(() {
      switch (_themeMode) {
        case ThemeMode.system:
          _themeMode = ThemeMode.light;
          break;
        case ThemeMode.light:
          _themeMode = ThemeMode.dark;
          break;
        case ThemeMode.dark:
          _themeMode = ThemeMode.system;
          break;
      }
    });
  }

  void _setUserType(UserType userType) {
    setState(() {
      _userType = userType;
      if (userType == UserType.student) {
        _dataService.setCurrentUser(DemoUsers.studentId, userType);
      } else {
        _dataService.setCurrentUser(DemoUsers.teacherId, userType);
      }
    });
  }

  void _logout() {
    setState(() {
      _userType = null;
      _dataService.setCurrentUser('', UserType.student);
    });
  }

  String get _themeDisplayName {
    switch (_themeMode) {
      case ThemeMode.system:
        return 'Systém';
      case ThemeMode.light:
        return 'Světlý';
      case ThemeMode.dark:
        return 'Tmavý';
    }
  }

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Magistři',
      debugShowCheckedModeBanner: false,
      theme: AppTheme.lightTheme,
      darkTheme: AppTheme.darkTheme,
      themeMode: _themeMode,
      builder: (context, child) {
        final brightness = Theme.of(context).brightness;
        final gradient = brightness == Brightness.dark
            ? AppTheme.darkBackgroundGradient
            : AppTheme.lightBackgroundGradient;

        return AnimatedContainer(
          duration: const Duration(milliseconds: 350),
          curve: Curves.easeOutCubic,
          decoration: BoxDecoration(gradient: gradient),
          child: child ?? const SizedBox.shrink(),
        );
      },
      home: AnimatedSwitcher(
        duration: const Duration(milliseconds: 550),
        switchInCurve: Curves.easeOutCubic,
        switchOutCurve: Curves.easeInCubic,
        child: _userType == null
            ? LoginScreen(
          key: const ValueKey('login_screen'),
          onLogin: _setUserType,
        )
            : DashboardScreen(
          key: const ValueKey('dashboard_screen'),
          userType: _userType!,
          onLogout: _logout,
          onThemeToggle: _cycleTheme,
          currentThemeMode: _themeMode,
          effectiveIsDark: _effectiveIsDark,
          themeDisplayName: _themeDisplayName,
        ),
      ),
    );
  }
}


================================================================================

File: models/data_models.dart
------------------------------------------------------------
import 'package:flutter/material.dart';


class Student {
  final String id;
  final String firstName;
  final String lastName;
  final String classId;
  final String email;
  final DateTime birthDate;
  final String parentEmail;
  final String parentPhone;
  final String address;

  Student({
    required this.id,
    required this.firstName,
    required this.lastName,
    required this.classId,
    required this.email,
    required this.birthDate,
    required this.parentEmail,
    required this.parentPhone,
    required this.address,
  });

  String get fullName => '$firstName $lastName';
}

class Teacher {
  final String id;
  final String firstName;
  final String lastName;
  final String email;
  final String phone;
  final List<String> subjectIds;
  final List<String> classIds;
  final String title;

  Teacher({
    required this.id,
    required this.firstName,
    required this.lastName,
    required this.email,
    required this.phone,
    required this.subjectIds,
    required this.classIds,
    required this.title,
  });

  String get fullName => '$title $firstName $lastName';
}

class SchoolClass {
  final String id;
  final String name;
  final String teacherId;
  final List<String> studentIds;
  final int year;

  SchoolClass({
    required this.id,
    required this.name,
    required this.teacherId,
    required this.studentIds,
    required this.year,
  });
}

class Subject {
  final String id;
  final String name;
  final String shortName;
  final Color color;

  Subject({
    required this.id,
    required this.name,
    required this.shortName,
    required this.color,
  });
}


class TimetableEntry {
  final String id;
  final String subjectId;
  final String teacherId;
  final String classId;
  final String room;
  final int dayOfWeek;
  final int period;
  final DateTime startTime;
  final DateTime endTime;

  TimetableEntry({
    required this.id,
    required this.subjectId,
    required this.teacherId,
    required this.classId,
    required this.room,
    required this.dayOfWeek,
    required this.period,
    required this.startTime,
    required this.endTime,
  });
}

class Grade {
  final String id;
  final String studentId;
  final String subjectId;
  final String teacherId;
  final int value;   final String? description;
  final DateTime date;
  final GradeType type;
  final double weight;

  Grade({
    required this.id,
    required this.studentId,
    required this.subjectId,
    required this.teacherId,
    required this.value,
    this.description,
    required this.date,
    required this.type,
    required this.weight,
  });
}

enum GradeType {
  test,
  homework,
  classwork,
  project,
  exam,
}

class Attendance {
  final String id;
  final String studentId;
  final String subjectId;
  final DateTime date;
  final int period;
  final AttendanceType type;
  final String? note;
  final bool excused;

  Attendance({
    required this.id,
    required this.studentId,
    required this.subjectId,
    required this.date,
    required this.period,
    required this.type,
    this.note,
    required this.excused,
  });
}

enum AttendanceType {
  present,
  absent,
  late,
  excused,
}

class Assignment {
  final String id;
  final String title;
  final String description;
  final String subjectId;
  final String teacherId;
  final List<String> classIds;
  final DateTime dueDate;
  final DateTime assignedDate;
  final AssignmentType type;
  final List<String> attachments;

  Assignment({
    required this.id,
    required this.title,
    required this.description,
    required this.subjectId,
    required this.teacherId,
    required this.classIds,
    required this.dueDate,
    required this.assignedDate,
    required this.type,
    required this.attachments,
  });
}

enum AssignmentType {
  homework,
  project,
  reading,
  research,
  presentation,
}

class Message {
  final String id;
  final String fromId;
  final List<String> toIds;
  final String subject;
  final String content;
  final DateTime sentDate;
  final bool isRead;
  final MessageType type;
  final String? parentMessageId;

  Message({
    required this.id,
    required this.fromId,
    required this.toIds,
    required this.subject,
    required this.content,
    required this.sentDate,
    required this.isRead,
    required this.type,
    this.parentMessageId,
  });
}

enum MessageType {
  personal,
  announcement,
  reminder,
  urgent,
}

class SchoolEvent {
  final String id;
  final String title;
  final String description;
  final DateTime startDate;
  final DateTime endDate;
  final String location;
  final EventType type;
  final List<String> targetClassIds;
  final String organizerId;

  SchoolEvent({
    required this.id,
    required this.title,
    required this.description,
    required this.startDate,
    required this.endDate,
    required this.location,
    required this.type,
    required this.targetClassIds,
    required this.organizerId,
  });
}

enum EventType {
  exam,
  trip,
  meeting,
  ceremony,
  sports,
  cultural,
  holiday,
}


class Document {
  final String id;
  final String title;
  final String description;
  final String fileName;
  final String fileType;
  final DateTime uploadDate;
  final String uploaderId;
  final List<String> targetClassIds;
  final DocumentCategory category;

  Document({
    required this.id,
    required this.title,
    required this.description,
    required this.fileName,
    required this.fileType,
    required this.uploadDate,
    required this.uploaderId,
    required this.targetClassIds,
    required this.category,
  });
}

enum DocumentCategory {
  syllabus,
  material,
  form,
  announcement,
  policy,
}


================================================================================

File: models/user_model.dart
------------------------------------------------------------
import 'package:flutter/material.dart';

enum UserType {
  student,
  teacher,
}

class User {
  final String name;
  final UserType type;
  final String id;

  User({required this.name, required this.type, required this.id});
}

class DashboardModule {
  final String title;
  final IconData icon;
  final Color color;
  final VoidCallback? onTap;

  DashboardModule({
    required this.title,
    required this.icon,
    required this.color,
    this.onTap,
  });
}


class DemoUsers {
  static const String studentId = 'student1';
  static const String teacherId = 'teacher1';

  static User getStudentUser() => User(
    id: studentId,
    name: 'Tomáš Kolář',
    type: UserType.student,
  );

  static User getTeacherUser() => User(
    id: teacherId,
    name: 'Mgr. Jan Novák',
    type: UserType.teacher,
  );
}


================================================================================

File: screens/dashboard_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';

import '../models/user_model.dart';
import '../services/data_service.dart';
import '../theme/app_theme.dart';
import 'grades_screen.dart';
import 'teacher_classes_screen.dart';
import 'timetable_screen.dart';
import 'teacher_timetable_screen.dart';

class DashboardScreen extends StatelessWidget {
  final UserType userType;
  final VoidCallback onLogout;
  final VoidCallback onThemeToggle;
  final ThemeMode currentThemeMode;
  final bool effectiveIsDark;
  final String themeDisplayName;

  const DashboardScreen({
    super.key,
    required this.userType,
    required this.onLogout,
    required this.onThemeToggle,
    required this.currentThemeMode,
    required this.effectiveIsDark,
    required this.themeDisplayName,
  });

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;

    return Scaffold(
      backgroundColor: Colors.transparent,
      body: SafeArea(
        child: Column(
          children: [
            _buildHeader(context, isDesktop),
            Expanded(
              child: _buildDashboardGrid(context, isDesktop),
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildHeader(BuildContext context, bool isDesktop) {
    final dataService = DataService();
    String userName = '';

    if (userType == UserType.student) {
      final student = dataService.getCurrentStudent();
      userName = student?.fullName ?? 'Žák';
    } else {
      final teacher = dataService.getCurrentTeacher();
      userName = teacher?.fullName ?? 'Učitel';
    }

    final bool isDark = Theme.of(context).brightness == Brightness.dark;

    return Padding(
      padding: EdgeInsets.all(isDesktop ? 12 : 16),
      child: AppTheme.glass(
        borderRadius: isDesktop ? 24 : 26,
        padding: EdgeInsets.symmetric(
          horizontal: isDesktop ? 16 : 20,
          vertical: isDesktop ? 10 : 12,
        ),
        color: isDark
            ? Colors.white.withOpacity(0.05)
            : Colors.white.withOpacity(0.8),
        child: Row(
          children: [
            IconButton(
              onPressed: () => _showMenuDialog(context),
              icon: Icon(
                Icons.menu_rounded,
                size: isDesktop ? 22 : 26,
                color: isDark ? Colors.white : Colors.black87,
              ),
            ),
            const SizedBox(width: 8),
            Text(
              'Přehled',
              style: Theme.of(context).textTheme.headlineMedium?.copyWith(
                fontSize: isDesktop ? 18 : 20,
                color: isDark ? Colors.white : Colors.black87,
              ),
            ),
            const Spacer(),
            Container(
              padding: EdgeInsets.symmetric(
                horizontal: isDesktop ? 10 : 14,
                vertical: isDesktop ? 4 : 6,
              ),
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(isDesktop ? 18 : 22),
                color: isDark
                    ? Colors.white.withOpacity(0.08)
                    : Colors.black.withOpacity(0.06),
              ),
              child: Row(
                mainAxisSize: MainAxisSize.min,
                children: [
                  Icon(
                    userType == UserType.student
                        ? Icons.person_outline
                        : Icons.person_4_outlined,
                    size: isDesktop ? 18 : 20,
                    color: isDark ? Colors.white : Colors.black87,
                  ),
                  SizedBox(width: isDesktop ? 6 : 8),
                  Text(
                    '$userName • ${userType == UserType.student ? 'žák' : 'učitel'}',
                    style: TextStyle(
                      color: isDark ? Colors.white : Colors.black87,
                      fontWeight: FontWeight.w500,
                      fontSize: isDesktop ? 12 : 14,
                    ),
                  ),
                ],
              ),
            ),
            SizedBox(width: isDesktop ? 8 : 10),
            Tooltip(
              message: 'Režim: $themeDisplayName',
              child: IconButton(
                onPressed: onThemeToggle,
                icon: Row(
                  mainAxisSize: MainAxisSize.min,
                  children: [
                    Icon(
                      _getThemeIcon(),
                      size: isDesktop ? 22 : 24,
                      color: isDark ? Colors.white : Colors.black87,
                    ),
                    if (currentThemeMode == ThemeMode.system)
                      Container(
                        margin: const EdgeInsets.only(left: 3),
                        width: 6,
                        height: 6,
                        decoration: BoxDecoration(
                          color: Theme.of(context).primaryColor,
                          shape: BoxShape.circle,
                        ),
                      ),
                  ],
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }

  IconData _getThemeIcon() {
    switch (currentThemeMode) {
      case ThemeMode.system:
        return Icons.brightness_auto_rounded;
      case ThemeMode.light:
        return Icons.light_mode_rounded;
      case ThemeMode.dark:
        return Icons.dark_mode_rounded;
    }
  }

  Widget _buildDashboardGrid(BuildContext context, bool isDesktop) {
    final modules = _getModules(context);
    final screenWidth = MediaQuery.of(context).size.width;

    int crossAxisCount;
    double childAspectRatio;
    double maxWidth;

    if (screenWidth > 1200) {
      crossAxisCount = 6;
      childAspectRatio = 1.0;
      maxWidth = 1200;
    } else if (screenWidth > 800) {
      crossAxisCount = 5;
      childAspectRatio = 1.0;
      maxWidth = 1000;
    } else if (screenWidth > 600) {
      crossAxisCount = 4;
      childAspectRatio = 0.95;
      maxWidth = double.infinity;
    } else {
      crossAxisCount = 3;
      childAspectRatio = 0.9;
      maxWidth = double.infinity;
    }

    return Center(
      child: Container(
        constraints: BoxConstraints(maxWidth: maxWidth),
        padding: EdgeInsets.all(isDesktop ? 12 : 16),
        child: GridView.builder(
          gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
            crossAxisCount: crossAxisCount,
            childAspectRatio: childAspectRatio,
            crossAxisSpacing: isDesktop ? 10 : 12,
            mainAxisSpacing: isDesktop ? 10 : 12,
          ),
          itemCount: modules.length,
          itemBuilder: (context, index) {
            final module = modules[index];
            return TweenAnimationBuilder<double>(
              tween: Tween(begin: 0, end: 1),
              duration: Duration(milliseconds: 420 + index * 40),
              curve: Curves.easeOutCubic,
              builder: (context, value, child) {
                return Transform.translate(
                  offset: Offset(0, 26 * (1 - value)),
                  child: Opacity(
                    opacity: value,
                    child: child,
                  ),
                );
              },
              child: _buildModuleCard(context, module, isDesktop),
            );
          },
        ),
      ),
    );
  }

  Widget _buildModuleCard(
      BuildContext context, DashboardModule module, bool isDesktop) {
    final bool isDark = Theme.of(context).brightness == Brightness.dark;
    final double radius = isDesktop ? 18 : 22;

    return AppTheme.glass(
      borderRadius: radius,
      color: isDark
          ? Colors.white.withOpacity(0.06)
          : Colors.white.withOpacity(0.9),
      padding: EdgeInsets.all(isDesktop ? 12 : 16),
      border: BorderSide(
        color: module.color.withOpacity(0.5),
        width: 1.1,
      ),
      onTap: module.onTap ?? () => _showComingSoonDialog(context),
      child: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          Container(
            width: isDesktop ? 40 : 50,
            height: isDesktop ? 40 : 50,
            decoration: BoxDecoration(
              gradient: LinearGradient(
                colors: [
                  module.color,
                  module.color.withOpacity(0.7),
                ],
                begin: Alignment.topLeft,
                end: Alignment.bottomRight,
              ),
              borderRadius: BorderRadius.circular(isDesktop ? 10 : 12),
              boxShadow: [
                BoxShadow(
                  color: module.color.withOpacity(0.4),
                  blurRadius: 18,
                  offset: const Offset(0, 8),
                ),
              ],
            ),
            child: Icon(
              module.icon,
              color: Colors.white,
              size: isDesktop ? 20 : 24,
            ),
          ),
          SizedBox(height: isDesktop ? 10 : 12),
          Text(
            module.title,
            textAlign: TextAlign.center,
            style: Theme.of(context).textTheme.bodyMedium?.copyWith(
              fontWeight: FontWeight.w500,
              fontSize: isDesktop ? 11 : 13,
              color: isDark ? Colors.white : Colors.black87,
            ),
            maxLines: 2,
            overflow: TextOverflow.ellipsis,
          ),
        ],
      ),
    );
  }

  List<DashboardModule> _getModules(BuildContext context) {
    if (userType == UserType.student) {
      return [
        DashboardModule(
          title: 'Komens',
          icon: Icons.chat_bubble_outline,
          color: const Color(0xFF64B5F6),
        ),
        DashboardModule(
          title: 'Absence',
          icon: Icons.event_busy_outlined,
          color: const Color(0xFFE91E63),
        ),
        DashboardModule(
          title: 'Plán akcí',
          icon: Icons.event_outlined,
          color: const Color(0xFFFF9800),
        ),
        DashboardModule(
          title: 'Známky',
          icon: Icons.grade_outlined,
          color: const Color(0xFF2196F3),
          onTap: () => Navigator.of(context).push(
            MaterialPageRoute(builder: (context) => const GradesScreen()),
          ),
        ),
        DashboardModule(
          title: 'Rozvrh',
          icon: Icons.table_chart_outlined,
          color: const Color(0xFFFF9800),
          onTap: () => Navigator.of(context).push(
            MaterialPageRoute(builder: (context) => const TimetableScreen()),
          ),
        ),
        DashboardModule(
          title: 'Suplování',
          icon: Icons.swap_horiz_outlined,
          color: const Color(0xFFFF7043),
        ),
        DashboardModule(
          title: 'Předměty',
          icon: Icons.menu_book_outlined,
          color: const Color(0xFF4CAF50),
        ),
        DashboardModule(
          title: 'Výuka',
          icon: Icons.school_outlined,
          color: const Color(0xFF9C27B0),
        ),
        DashboardModule(
          title: 'Domácí úkoly',
          icon: Icons.assignment_outlined,
          color: const Color(0xFF00BCD4),
        ),
        DashboardModule(
          title: 'GDPR',
          icon: Icons.security_outlined,
          color: const Color(0xFF795548),
        ),
        DashboardModule(
          title: 'Infokanál',
          icon: Icons.info_outline,
          color: const Color(0xFF009688),
        ),
        DashboardModule(
          title: 'Dokumenty',
          icon: Icons.description_outlined,
          color: const Color(0xFF673AB7),
        ),
        DashboardModule(
          title: 'Ankety',
          icon: Icons.poll_outlined,
          color: const Color(0xFF8BC34A),
        ),
        DashboardModule(
          title: 'Výukové zdroje',
          icon: Icons.library_books_outlined,
          color: const Color(0xFF3F51B5),
        ),
      ];
    } else {
      return [
        DashboardModule(
          title: 'Třídní kniha',
          icon: Icons.book_outlined,
          color: const Color(0xFF2196F3),
        ),
        DashboardModule(
          title: 'Rozvrh',
          icon: Icons.table_chart_outlined,
          color: const Color(0xFFFF9800),
          onTap: () => Navigator.of(context).push(
            MaterialPageRoute(builder: (context) => const TeacherTimetableScreen()),
          ),
        ),
        DashboardModule(
          title: 'Známkování',
          icon: Icons.grade_outlined,
          color: const Color(0xFF4CAF50),
          onTap: () => Navigator.of(context).push(
            MaterialPageRoute(
              builder: (context) => const TeacherSubjectsScreen(),
            ),
          ),
        ),
        DashboardModule(
          title: 'Docházka',
          icon: Icons.how_to_reg_outlined,
          color: const Color(0xFFE91E63),
        ),
        DashboardModule(
          title: 'Žáci',
          icon: Icons.people_outline,
          color: const Color(0xFF9C27B0),
        ),
        DashboardModule(
          title: 'Úkoly',
          icon: Icons.assignment_outlined,
          color: const Color(0xFF00BCD4),
        ),
        DashboardModule(
          title: 'Komunikace',
          icon: Icons.chat_outlined,
          color: const Color(0xFF64B5F6),
        ),
        DashboardModule(
          title: 'Materiály',
          icon: Icons.folder_outlined,
          color: const Color(0xFF795548),
        ),
        DashboardModule(
          title: 'Statistiky',
          icon: Icons.analytics_outlined,
          color: const Color(0xFF009688),
        ),
      ];
    }
  }

  void _showMenuDialog(BuildContext context) {
    showDialog(
      context: context,
      builder: (BuildContext context) {
        return AlertDialog(
          title: const Text('Menu'),
          content: Column(
            mainAxisSize: MainAxisSize.min,
            children: [
              ListTile(
                leading: const Icon(Icons.settings),
                title: const Text('Nastavení'),
                onTap: () {
                  Navigator.of(context).pop();
                  _showComingSoonDialog(context);
                },
              ),
              ListTile(
                leading: Icon(_getThemeIcon()),
                title: Text('Vzhled: $themeDisplayName'),
                subtitle: Text(_getThemeSubtitle()),
                onTap: () {
                  Navigator.of(context).pop();
                  onThemeToggle();
                },
              ),
              ListTile(
                leading: const Icon(Icons.logout),
                title: const Text('Odhlásit se'),
                onTap: () {
                  Navigator.of(context).pop();
                  onLogout();
                },
              ),
            ],
          ),
        );
      },
    );
  }

  String _getThemeSubtitle() {
    switch (currentThemeMode) {
      case ThemeMode.system:
        return 'Automaticky dle systému';
      case ThemeMode.light:
        return 'Vždy světlý režim';
      case ThemeMode.dark:
        return 'Vždy tmavý režim';
    }
  }

  void _showComingSoonDialog(BuildContext context) {
    showDialog(
      context: context,
      builder: (BuildContext context) {
        return const AlertDialog(
          title: Text('Připravujeme'),
          content: Text(
            'Tato funkce bude dostupná v plné verzi aplikace.',
          ),
        );
      },
    );
  }
}


================================================================================

File: screens/grades_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../services/data_service.dart';
import '../models/data_models.dart';
import '../theme/app_theme.dart';

class GradesScreen extends StatefulWidget {
  const GradesScreen({super.key});

  @override
  State<GradesScreen> createState() => _GradesScreenState();
}

class _GradesScreenState extends State<GradesScreen>
    with TickerProviderStateMixin {
  final DataService _dataService = DataService();
  Set<String> expandedSubjects = {};
  late AnimationController _animationController;

  @override
  void initState() {
    super.initState();
    _animationController = AnimationController(
      duration: const Duration(milliseconds: 300),
      vsync: this,
    );
  }

  @override
  void dispose() {
    _animationController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;

    final currentStudent = _dataService.getCurrentStudent();
    if (currentStudent == null) {
      return Scaffold(
        backgroundColor: Colors.transparent,
        appBar: AppBar(
          title: const Text('Známky'),
          backgroundColor: Colors.transparent,
        ),
        body: const Center(child: Text('Žádný student není přihlášen')),
      );
    }

    final grades = _dataService.getGradesForStudent(currentStudent.id);
    final subjects = _dataService.subjects;

    Map<Subject, List<Grade>> gradesBySubject = {};
    Map<Subject, double> subjectAverages = {};

    for (var subject in subjects) {
      final subjectGrades =
      grades.where((g) => g.subjectId == subject.id).toList();
      if (subjectGrades.isNotEmpty) {
        gradesBySubject[subject] = subjectGrades;
        subjectAverages[subject] = _calculateWeightedAverage(subjectGrades);
      }
    }

    return Scaffold(
      backgroundColor: Colors.transparent,
      appBar: AppBar(
        title: const Text('Známky'),
        backgroundColor: Colors.transparent,
        actions: [
          IconButton(
            icon: const Icon(Icons.info_outline),
            onPressed: () => _showGradeInfoDialog(context),
          ),
        ],
      ),
      body: isDesktop
          ? _buildDesktopLayout(grades, gradesBySubject, subjectAverages)
          : _buildMobileLayout(grades, gradesBySubject, subjectAverages),
    );
  }

  Widget _buildDesktopLayout(
      List<Grade> grades,
      Map<Subject, List<Grade>> gradesBySubject,
      Map<Subject, double> subjectAverages,
      ) {
    return Row(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Container(
          width: 350,
          padding: const EdgeInsets.all(16),
          child: Column(
            children: [
              _buildOverallSummaryCard(grades, subjectAverages, true),
              const SizedBox(height: 16),
              _buildGradeDistributionCard(grades),
            ],
          ),
        ),
        Expanded(
          child: Container(
            padding: const EdgeInsets.all(16),
            child: _buildSubjectsList(gradesBySubject, subjectAverages, true),
          ),
        ),
      ],
    );
  }

  Widget _buildMobileLayout(
      List<Grade> grades,
      Map<Subject, List<Grade>> gradesBySubject,
      Map<Subject, double> subjectAverages,
      ) {
    return Column(
      children: [
        _buildOverallSummaryCard(grades, subjectAverages, false),
        Expanded(
          child: _buildSubjectsList(gradesBySubject, subjectAverages, false),
        ),
      ],
    );
  }

  Widget _buildOverallSummaryCard(
      List<Grade> grades,
      Map<Subject, double> subjectAverages,
      bool isDesktop,
      ) {
    if (grades.isEmpty) return const SizedBox.shrink();

    final overallAverage = _calculateOverallAverage(subjectAverages);
    final totalGrades = grades.length;
    final totalSubjects = subjectAverages.length;

    return Container(
      margin: EdgeInsets.all(isDesktop ? 0 : 16),
      width: double.infinity,
      child: AppTheme.glass(
        borderRadius: isDesktop ? 20 : 22,
        padding: EdgeInsets.all(isDesktop ? 16 : 20),
        color: Colors.white.withOpacity(0.10),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(
              'Celkový přehled',
              style: TextStyle(
                fontSize: isDesktop ? 18 : 20,
                fontWeight: FontWeight.bold,
                color: Colors.white,
              ),
            ),
            const SizedBox(height: 16),
            isDesktop
                ? Column(
              children: [
                _buildDesktopSummaryRow(
                  'Celkový průměr',
                  overallAverage.toStringAsFixed(2),
                  _getGradeColor(overallAverage.round()),
                ),
                const SizedBox(height: 12),
                _buildDesktopSummaryRow(
                  'Předměty',
                  totalSubjects.toString(),
                  Colors.blue,
                ),
                const SizedBox(height: 12),
                _buildDesktopSummaryRow(
                  'Celkem známek',
                  totalGrades.toString(),
                  Colors.green,
                ),
              ],
            )
                : Row(
              mainAxisAlignment: MainAxisAlignment.spaceEvenly,
              children: [
                _buildSummaryColumn(
                  'Celkový průměr',
                  overallAverage.toStringAsFixed(2),
                  _getGradeColor(overallAverage.round()),
                ),
                _buildSummaryColumn(
                  'Předměty',
                  totalSubjects.toString(),
                  Colors.blue,
                ),
                _buildSummaryColumn(
                  'Celkem známek',
                  totalGrades.toString(),
                  Colors.green,
                ),
              ],
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildDesktopSummaryRow(String label, String value, Color color) {
    return Row(
      children: [
        Container(
          width: 40,
          height: 40,
          decoration: BoxDecoration(
            color: color,
            borderRadius: BorderRadius.circular(20),
          ),
          child: Center(
            child: Text(
              value,
              style: const TextStyle(
                color: Colors.white,
                fontSize: 14,
                fontWeight: FontWeight.bold,
              ),
            ),
          ),
        ),
        const SizedBox(width: 12),
        Text(
          label,
          style: const TextStyle(
            fontSize: 14,
            fontWeight: FontWeight.w500,
            color: Colors.white,
          ),
        ),
      ],
    );
  }

  Widget _buildGradeDistributionCard(List<Grade> grades) {
    final distribution = _getGradeDistribution(grades);

    return AppTheme.glass(
      borderRadius: 20,
      padding: const EdgeInsets.all(16),
      color: Colors.white.withOpacity(0.10),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          const Text(
            'Rozložení známek',
            style: TextStyle(
              fontSize: 16,
              fontWeight: FontWeight.bold,
              color: Colors.white,
            ),
          ),
          const SizedBox(height: 12),
          ...List.generate(5, (index) {
            final grade = index + 1;
            final count = distribution[grade] ?? 0;
            return Padding(
              padding: const EdgeInsets.symmetric(vertical: 4),
              child: Row(
                children: [
                  Container(
                    width: 24,
                    height: 24,
                    decoration: BoxDecoration(
                      color: _getGradeColor(grade),
                      shape: BoxShape.circle,
                    ),
                    child: Center(
                      child: Text(
                        grade.toString(),
                        style: const TextStyle(
                          color: Colors.white,
                          fontSize: 12,
                          fontWeight: FontWeight.bold,
                        ),
                      ),
                    ),
                  ),
                  const SizedBox(width: 8),
                  Text(
                    '$count známek',
                    style: const TextStyle(
                      fontSize: 12,
                      color: Colors.white,
                    ),
                  ),
                ],
              ),
            );
          }),
        ],
      ),
    );
  }

  Widget _buildSummaryColumn(String label, String value, Color color) {
    return Column(
      children: [
        Container(
          width: 50,
          height: 50,
          decoration: BoxDecoration(
            color: color,
            borderRadius: BorderRadius.circular(25),
          ),
          child: Center(
            child: Text(
              value,
              style: const TextStyle(
                color: Colors.white,
                fontSize: 16,
                fontWeight: FontWeight.bold,
              ),
            ),
          ),
        ),
        const SizedBox(height: 8),
        Text(
          label,
          style: const TextStyle(
            fontSize: 12,
            fontWeight: FontWeight.w500,
            color: Colors.white,
          ),
          textAlign: TextAlign.center,
        ),
      ],
    );
  }

  Widget _buildSubjectsList(
      Map<Subject, List<Grade>> gradesBySubject,
      Map<Subject, double> subjectAverages,
      bool isDesktop,
      ) {
    if (gradesBySubject.isEmpty) {
      return const Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(Icons.school_outlined, size: 64, color: Colors.grey),
            SizedBox(height: 16),
            Text(
              'Žádné známky nejsou k dispozici',
              style: TextStyle(fontSize: 16, color: Colors.grey),
            ),
          ],
        ),
      );
    }

    final sortedSubjects = gradesBySubject.keys.toList()
      ..sort((a, b) => a.name.compareTo(b.name));

    return ListView.builder(
      padding: EdgeInsets.all(isDesktop ? 0 : 16),
      itemCount: sortedSubjects.length,
      itemBuilder: (context, index) {
        final subject = sortedSubjects[index];
        final subjectGrades = gradesBySubject[subject]!;
        final average = subjectAverages[subject]!;
        final isExpanded = expandedSubjects.contains(subject.id);

        return _buildSubjectCard(
          subject,
          subjectGrades,
          average,
          isExpanded,
          isDesktop,
        );
      },
    );
  }

  Widget _buildSubjectCard(
      Subject subject,
      List<Grade> grades,
      double average,
      bool isExpanded,
      bool isDesktop,
      ) {
    return Container(
      margin: const EdgeInsets.only(bottom: 12),
      child: AppTheme.glass(
        borderRadius: 16,
        color: Colors.white.withOpacity(0.08),
        child: Column(
          children: [
            InkWell(
              onTap: () {
                setState(() {
                  if (isExpanded) {
                    expandedSubjects.remove(subject.id);
                  } else {
                    expandedSubjects.add(subject.id);
                  }
                });
              },
              borderRadius: BorderRadius.circular(16),
              child: Container(
                padding: EdgeInsets.all(isDesktop ? 12 : 16),
                child: Row(
                  children: [
                    Container(
                      width: isDesktop ? 40 : 48,
                      height: isDesktop ? 40 : 48,
                      decoration: BoxDecoration(
                        gradient: LinearGradient(
                          colors: [
                            subject.color,
                            subject.color.withOpacity(0.7),
                          ],
                          begin: Alignment.topLeft,
                          end: Alignment.bottomRight,
                        ),
                        borderRadius:
                        BorderRadius.circular(isDesktop ? 10 : 12),
                      ),
                      child: Center(
                        child: Text(
                          subject.shortName,
                          style: TextStyle(
                            color: Colors.white,
                            fontWeight: FontWeight.bold,
                            fontSize: isDesktop ? 12 : 14,
                          ),
                        ),
                      ),
                    ),
                    SizedBox(width: isDesktop ? 12 : 16),
                    Expanded(
                      child: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Text(
                            subject.name,
                            style: TextStyle(
                              fontSize: isDesktop ? 14 : 16,
                              fontWeight: FontWeight.bold,
                              color: Colors.white,
                            ),
                          ),
                          const SizedBox(height: 4),
                          Text(
                            '${grades.length} známek',
                            style: TextStyle(
                              fontSize: isDesktop ? 12 : 14,
                              color: Colors.grey[300],
                            ),
                          ),
                        ],
                      ),
                    ),
                    Container(
                      width: isDesktop ? 40 : 50,
                      height: isDesktop ? 40 : 50,
                      decoration: BoxDecoration(
                        color: _getGradeColor(average.round()),
                        borderRadius:
                        BorderRadius.circular(isDesktop ? 20 : 25),
                      ),
                      child: Center(
                        child: Text(
                          average.toStringAsFixed(1),
                          style: TextStyle(
                            color: Colors.white,
                            fontWeight: FontWeight.bold,
                            fontSize: isDesktop ? 12 : 14,
                          ),
                        ),
                      ),
                    ),
                    SizedBox(width: isDesktop ? 6 : 8),
                    AnimatedRotation(
                      turns: isExpanded ? 0.5 : 0.0,
                      duration: const Duration(milliseconds: 300),
                      child: const Icon(
                        Icons.keyboard_arrow_down,
                        size: 24,
                        color: Colors.white,
                      ),
                    ),
                  ],
                ),
              ),
            ),
            AnimatedCrossFade(
              duration: const Duration(milliseconds: 300),
              crossFadeState: isExpanded
                  ? CrossFadeState.showSecond
                  : CrossFadeState.showFirst,
              firstChild: const SizedBox.shrink(),
              secondChild: Container(
                decoration: BoxDecoration(
                  color:
                  Theme.of(context).colorScheme.surface.withOpacity(0.4),
                  borderRadius: const BorderRadius.only(
                    bottomLeft: Radius.circular(16),
                    bottomRight: Radius.circular(16),
                  ),
                ),
                child: Column(
                  children: grades
                      .map((grade) => _buildGradeItem(grade, isDesktop))
                      .toList(),
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildGradeItem(Grade grade, bool isDesktop) {
    final teacher = _dataService.getTeacherById(grade.teacherId);

    return Container(
      padding: EdgeInsets.symmetric(
        horizontal: isDesktop ? 12 : 16,
        vertical: isDesktop ? 6 : 8,
      ),
      child: Row(
        children: [
          Container(
            width: isDesktop ? 32 : 40,
            height: isDesktop ? 32 : 40,
            decoration: BoxDecoration(
              color: _getGradeColor(grade.value),
              shape: BoxShape.circle,
            ),
            child: Center(
              child: Text(
                grade.value.toString(),
                style: TextStyle(
                  color: Colors.white,
                  fontWeight: FontWeight.bold,
                  fontSize: isDesktop ? 14 : 16,
                ),
              ),
            ),
          ),
          SizedBox(width: isDesktop ? 12 : 16),
          Expanded(
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  grade.description ?? 'Známka bez popisu',
                  style: TextStyle(
                    fontSize: isDesktop ? 13 : 14,
                    fontWeight: FontWeight.w600,
                    color: Colors.white,
                  ),
                ),
                const SizedBox(height: 4),
                Row(
                  children: [
                    Text(
                      _getGradeTypeText(grade.type),
                      style: TextStyle(
                        fontSize: isDesktop ? 10 : 11,
                        color: Theme.of(context).primaryColor,
                        fontWeight: FontWeight.w500,
                      ),
                    ),
                    Text(
                      ' • ',
                      style: TextStyle(
                        fontSize: isDesktop ? 10 : 11,
                        color: Colors.grey[300],
                      ),
                    ),
                    Text(
                      _formatDate(grade.date),
                      style: TextStyle(
                        fontSize: isDesktop ? 10 : 12,
                        color: Colors.grey[300],
                      ),
                    ),
                  ],
                ),
                if (teacher != null)
                  Text(
                    teacher.fullName,
                    style: TextStyle(
                      fontSize: isDesktop ? 10 : 11,
                      color: Colors.grey[400],
                    ),
                  ),
              ],
            ),
          ),
          Container(
            padding: EdgeInsets.symmetric(
              horizontal: isDesktop ? 6 : 8,
              vertical: isDesktop ? 2 : 4,
            ),
            decoration: BoxDecoration(
              border: Border.all(color: Colors.grey[400]!),
              borderRadius: BorderRadius.circular(6),
            ),
            child: Text(
              'Váha: ${grade.weight.toInt()}',
              style: TextStyle(
                fontSize: isDesktop ? 10 : 11,
                fontWeight: FontWeight.w500,
                color: Colors.white,
              ),
            ),
          ),
        ],
      ),
    );
  }

  Map<int, int> _getGradeDistribution(List<Grade> grades) {
    Map<int, int> distribution = {};
    for (var grade in grades) {
      distribution[grade.value] = (distribution[grade.value] ?? 0) + 1;
    }
    return distribution;
  }

  double _calculateWeightedAverage(List<Grade> grades) {
    if (grades.isEmpty) return 0;

    double totalWeightedGrades = 0;
    double totalWeight = 0;

    for (var grade in grades) {
      totalWeightedGrades += grade.value * grade.weight;
      totalWeight += grade.weight;
    }

    return totalWeight > 0 ? totalWeightedGrades / totalWeight : 0;
  }

  double _calculateOverallAverage(Map<Subject, double> subjectAverages) {
    if (subjectAverages.isEmpty) return 0;
    return subjectAverages.values.reduce((a, b) => a + b) /
        subjectAverages.length;
  }

  Color _getGradeColor(int grade) {
    switch (grade) {
      case 1:
        return Colors.green;
      case 2:
        return Colors.lightGreen;
      case 3:
        return Colors.orange;
      case 4:
        return Colors.deepOrange;
      case 5:
        return Colors.red;
      default:
        return Colors.grey;
    }
  }

  String _getGradeTypeText(GradeType type) {
    switch (type) {
      case GradeType.test:
        return 'Test';
      case GradeType.homework:
        return 'DÚ';
      case GradeType.classwork:
        return 'Práce v hodině';
      case GradeType.project:
        return 'Projekt';
      case GradeType.exam:
        return 'Zkouška';
    }
  }

  String _formatDate(DateTime date) {
    return '${date.day}.${date.month}.${date.year}';
  }

  void _showGradeInfoDialog(BuildContext context) {
    showDialog(
      context: context,
      builder: (BuildContext context) {
        return const AlertDialog(
          title: Text('Hodnocení'),
          content: Column(
            mainAxisSize: MainAxisSize.min,
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Text(
                'Stupnice hodnocení:',
                style: TextStyle(fontWeight: FontWeight.bold),
              ),
              SizedBox(height: 8),
              Text('1 - Výborný'),
              Text('2 - Chvalitebný'),
              Text('3 - Dobrý'),
              Text('4 - Dostatečný'),
              Text('5 - Nedostatečný'),
              SizedBox(height: 12),
              Text(
                'Váha známek: 1-10',
                style: TextStyle(fontWeight: FontWeight.bold),
              ),
              Text('Vyšší váha = větší vliv na průměr'),
            ],
          ),
        );
      },
    );
  }
}


================================================================================

File: screens/login_screen.dart
------------------------------------------------------------
import 'dart:ui';

import 'package:flutter/material.dart';
import '../models/user_model.dart';
import '../theme/app_theme.dart';

class LoginScreen extends StatefulWidget {
  final Function(UserType) onLogin;

  const LoginScreen({super.key, required this.onLogin});

  @override
  State<LoginScreen> createState() => _LoginScreenState();
}

class _LoginScreenState extends State<LoginScreen>
    with SingleTickerProviderStateMixin {
  late final AnimationController _controller;
  late final Animation<double> _fadeAnimation;
  late final Animation<Offset> _slideAnimation;

  @override
  void initState() {
    super.initState();
    _controller = AnimationController(
      duration: const Duration(milliseconds: 900),
      vsync: this,
    );

    _fadeAnimation =
        CurvedAnimation(parent: _controller, curve: Curves.easeOutCubic);

    _slideAnimation = Tween<Offset>(
      begin: const Offset(0, 0.25),
      end: Offset.zero,
    ).animate(
      CurvedAnimation(parent: _controller, curve: Curves.easeOutCubic),
    );

    _controller.forward();
  }

  @override
  void dispose() {
    _controller.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;
    final cardWidth = isDesktop ? 420.0 : double.infinity;

    return Scaffold(
      backgroundColor: Colors.transparent,
      body: SafeArea(
        child: Center(
          child: SingleChildScrollView(
            child: ConstrainedBox(
              constraints: BoxConstraints(maxWidth: cardWidth),
              child: FadeTransition(
                opacity: _fadeAnimation,
                child: SlideTransition(
                  position: _slideAnimation,
                  child: Padding(
                    padding: EdgeInsets.symmetric(
                      horizontal: isDesktop ? 0 : 24,
                    ),
                    child: Column(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: [
                        _buildLogo(isDesktop),
                        SizedBox(height: isDesktop ? 24 : 36),
                        _buildLoginOptions(isDesktop),
                        SizedBox(height: isDesktop ? 28 : 44),
                        _buildDemoLabel(isDesktop),
                      ],
                    ),
                  ),
                ),
              ),
            ),
          ),
        ),
      ),
    );
  }

  Widget _buildLogo(bool isDesktop) {
    return Column(
      children: [
        AppTheme.glass(
          borderRadius: isDesktop ? 32 : 40,
          padding: EdgeInsets.all(isDesktop ? 26 : 32),
          color: Colors.white.withOpacity(0.10),
          child: const Icon(
            Icons.school_outlined,
            size: 56,
            color: Colors.white,
          ),
        ),
        SizedBox(height: isDesktop ? 18 : 24),
        Text(
          'Magistři',
          style: TextStyle(
            fontSize: isDesktop ? 30 : 38,
            fontWeight: FontWeight.bold,
            color: Colors.white,
            letterSpacing: 1.2,
            shadows: [
              Shadow(
                color: Colors.black.withOpacity(0.4),
                offset: const Offset(0, 6),
                blurRadius: 16,
              ),
            ],
          ),
        ),
        SizedBox(height: isDesktop ? 6 : 10),
        Text(
          'Demo školního systému',
          style: TextStyle(
            fontSize: isDesktop ? 14 : 16,
            color: Colors.white.withOpacity(0.85),
          ),
        ),
      ],
    );
  }

  Widget _buildLoginOptions(bool isDesktop) {
    return Column(
      children: [
        Text(
          'Vyberte typ účtu',
          style: TextStyle(
            fontSize: isDesktop ? 16 : 18,
            color: Colors.white,
            fontWeight: FontWeight.w500,
          ),
        ),
        SizedBox(height: isDesktop ? 26 : 32),
        _buildLoginOption(
          title: 'Žák',
          subtitle: 'Přihlásit se jako žák',
          icon: Icons.person_outline,
          isDesktop: isDesktop,
          onTap: () => widget.onLogin(UserType.student),
        ),
        SizedBox(height: isDesktop ? 14 : 18),
        _buildLoginOption(
          title: 'Učitel',
          subtitle: 'Přihlásit se jako učitel',
          icon: Icons.person_4_outlined,
          isDesktop: isDesktop,
          onTap: () => widget.onLogin(UserType.teacher),
        ),
      ],
    );
  }

  Widget _buildDemoLabel(bool isDesktop) {
    return Text(
      'Demo verze - žádná data nejsou skutečná',
      textAlign: TextAlign.center,
      style: TextStyle(
        fontSize: isDesktop ? 11 : 12,
        color: Colors.white.withOpacity(0.65),
      ),
    );
  }

  Widget _buildLoginOption({
    required String title,
    required String subtitle,
    required IconData icon,
    required VoidCallback onTap,
    required bool isDesktop,
  }) {
    final double radius = isDesktop ? 22 : 24;

    return AppTheme.glass(
      borderRadius: radius,
      padding: EdgeInsets.all(isDesktop ? 16 : 20),
      color: Colors.white.withOpacity(0.10),
      border: BorderSide(color: Colors.white.withOpacity(0.28)),
      onTap: onTap,
      child: Row(
        children: [
          Container(
            width: isDesktop ? 44 : 52,
            height: isDesktop ? 44 : 52,
            decoration: BoxDecoration(
              borderRadius: BorderRadius.circular(isDesktop ? 14 : 16),
              gradient: const LinearGradient(
                begin: Alignment.topLeft,
                end: Alignment.bottomRight,
                colors: [
                  Color(0xFF42A5F5),
                  Color(0xFF7E57C2),
                ],
              ),
            ),
            child: Icon(
              icon,
              color: Colors.white,
              size: isDesktop ? 22 : 26,
            ),
          ),
          SizedBox(width: isDesktop ? 14 : 18),
          Expanded(
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  title,
                  style:
                  Theme.of(context).textTheme.headlineMedium?.copyWith(
                    fontSize: isDesktop ? 18 : 20,
                    fontWeight: FontWeight.w600,
                    color: Colors.white,
                  ),
                ),
                SizedBox(height: isDesktop ? 4 : 6),
                Text(
                  subtitle,
                  style: Theme.of(context).textTheme.bodyMedium?.copyWith(
                    fontSize: isDesktop ? 12 : 14,
                    color: Colors.white.withOpacity(0.8),
                  ),
                ),
              ],
            ),
          ),
          Icon(
            Icons.arrow_forward_ios_rounded,
            color: Colors.white.withOpacity(0.8),
            size: isDesktop ? 16 : 18,
          ),
        ],
      ),
    );
  }
}


================================================================================

File: screens/teacher_class_detail_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../services/data_service.dart';
import '../models/data_models.dart';

class TeacherClassDetailScreen extends StatefulWidget {
  final String classId;

  const TeacherClassDetailScreen({super.key, required this.classId});

  @override
  State<TeacherClassDetailScreen> createState() => _TeacherClassDetailScreenState();
}

class _TeacherClassDetailScreenState extends State<TeacherClassDetailScreen> {
  final DataService _dataService = DataService();
  String? selectedSubjectId;
  Set<String> expandedGrades = {};

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;

    final schoolClass = _dataService.getClassById(widget.classId);
    final currentTeacher = _dataService.getCurrentTeacher();

    if (schoolClass == null || currentTeacher == null) {
      return Scaffold(
        appBar: AppBar(title: const Text('Třída')),
        body: const Center(child: Text('Třída nenalezena')),
      );
    }

    final teacherSubjects = _dataService.getSubjectsForTeacher(currentTeacher.id);
    final students = _dataService.getStudentsForClass(widget.classId);

    return Scaffold(
      appBar: AppBar(
        title: Text('Třída ${schoolClass.name}'),
        backgroundColor: Colors.transparent,
      ),
      body: Column(
        children: [
                    _buildClassHeader(schoolClass, students, teacherSubjects, isDesktop),
                    Expanded(
            child: _buildGradesView(teacherSubjects, students, isDesktop),
          ),
        ],
      ),
    );
  }

  Widget _buildClassHeader(SchoolClass schoolClass, List<Student> students, List<Subject> subjects, bool isDesktop) {
    return Container(
      margin: EdgeInsets.all(isDesktop ? 12 : 16),
      child: Card(
        child: Padding(
          padding: EdgeInsets.all(isDesktop ? 16 : 20),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Row(
                children: [
                  Container(
                    width: isDesktop ? 40 : 50,
                    height: isDesktop ? 40 : 50,
                    decoration: BoxDecoration(
                      gradient: const LinearGradient(
                        colors: [Colors.orange, Colors.deepOrange],
                        begin: Alignment.topLeft,
                        end: Alignment.bottomRight,
                      ),
                      borderRadius: BorderRadius.circular(isDesktop ? 10 : 12),
                    ),
                    child: Center(
                      child: Text(
                        schoolClass.name,
                        style: TextStyle(
                          color: Colors.white,
                          fontWeight: FontWeight.bold,
                          fontSize: isDesktop ? 12 : 14,
                        ),
                      ),
                    ),
                  ),
                  SizedBox(width: isDesktop ? 12 : 16),
                  Expanded(
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          'Třída ${schoolClass.name}',
                          style: TextStyle(
                            fontSize: isDesktop ? 16 : 18,
                            fontWeight: FontWeight.bold,
                          ),
                        ),
                        Text(
                          '${students.length} žáků • ${schoolClass.year}. ročník',
                          style: TextStyle(
                            fontSize: isDesktop ? 12 : 14,
                            color: Colors.grey[600],
                          ),
                        ),
                      ],
                    ),
                  ),
                ],
              ),
              const SizedBox(height: 16),
                            Row(
                children: [
                  Text(
                    'Předmět: ',
                    style: TextStyle(
                      fontSize: isDesktop ? 13 : 14,
                      fontWeight: FontWeight.w600,
                    ),
                  ),
                  const SizedBox(width: 8),
                  Expanded(
                    child: DropdownButton<String>(
                      value: selectedSubjectId,
                      hint: const Text('Všechny předměty'),
                      isExpanded: true,
                      items: [
                        const DropdownMenuItem<String>(
                          value: null,
                          child: Text('Všechny předměty'),
                        ),
                        ...subjects.map((subject) => DropdownMenuItem<String>(
                          value: subject.id,
                          child: Text(subject.name),
                        )),
                      ],
                      onChanged: (value) {
                        setState(() {
                          selectedSubjectId = value;
                          expandedGrades.clear();
                        });
                      },
                    ),
                  ),
                ],
              ),
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildGradesView(List<Subject> subjects, List<Student> students, bool isDesktop) {
    final filteredSubjects = selectedSubjectId == null
        ? subjects
        : subjects.where((s) => s.id == selectedSubjectId).toList();

    if (filteredSubjects.isEmpty) {
      return const Center(
        child: Text('Žádné předměty k zobrazení'),
      );
    }

    return ListView.builder(
      padding: EdgeInsets.all(isDesktop ? 12 : 16),
      itemCount: filteredSubjects.length,
      itemBuilder: (context, index) {
        final subject = filteredSubjects[index];
        return _buildSubjectSection(subject, students, isDesktop);
      },
    );
  }

  Widget _buildSubjectSection(Subject subject, List<Student> students, bool isDesktop) {
    final subjectGrades = _dataService.getGradesForClassAndSubject(widget.classId, subject.id);

        Map<int, List<Grade>> gradesByValue = {};
    for (var grade in subjectGrades) {
      if (gradesByValue[grade.value] == null) {
        gradesByValue[grade.value] = [];
      }
      gradesByValue[grade.value]!.add(grade);
    }

    return Card(
      margin: const EdgeInsets.only(bottom: 16),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
                    Container(
            padding: EdgeInsets.all(isDesktop ? 16 : 20),
            decoration: BoxDecoration(
              color: subject.color.withOpacity(0.1),
              borderRadius: const BorderRadius.only(
                topLeft: Radius.circular(12),
                topRight: Radius.circular(12),
              ),
            ),
            child: Row(
              children: [
                Container(
                  width: isDesktop ? 40 : 48,
                  height: isDesktop ? 40 : 48,
                  decoration: BoxDecoration(
                    color: subject.color,
                    borderRadius: BorderRadius.circular(isDesktop ? 10 : 12),
                  ),
                  child: Center(
                    child: Text(
                      subject.shortName,
                      style: TextStyle(
                        color: Colors.white,
                        fontWeight: FontWeight.bold,
                        fontSize: isDesktop ? 12 : 14,
                      ),
                    ),
                  ),
                ),
                SizedBox(width: isDesktop ? 12 : 16),
                Expanded(
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(
                        subject.name,
                        style: TextStyle(
                          fontSize: isDesktop ? 16 : 18,
                          fontWeight: FontWeight.bold,
                        ),
                      ),
                      Text(
                        '${subjectGrades.length} známek',
                        style: TextStyle(
                          fontSize: isDesktop ? 12 : 14,
                          color: Colors.grey[600],
                        ),
                      ),
                    ],
                  ),
                ),
              ],
            ),
          ),
                    if (subjectGrades.isEmpty)
            Container(
              padding: const EdgeInsets.all(20),
              child: const Center(
                child: Text(
                  'Žádné známky pro tento předmět',
                  style: TextStyle(color: Colors.grey),
                ),
              ),
            )
          else
            ...gradesByValue.entries.map((entry) {
              final gradeValue = entry.key;
              final gradesWithValue = entry.value;
              final isExpanded = expandedGrades.contains('${subject.id}_$gradeValue');

              return _buildGradeGroup(subject, gradeValue, gradesWithValue, students, isExpanded, isDesktop);
            }).toList(),
        ],
      ),
    );
  }

  Widget _buildGradeGroup(Subject subject, int gradeValue, List<Grade> grades, List<Student> students, bool isExpanded, bool isDesktop) {
    return Column(
      children: [
                InkWell(
          onTap: () {
            setState(() {
              final key = '${subject.id}_$gradeValue';
              if (isExpanded) {
                expandedGrades.remove(key);
              } else {
                expandedGrades.add(key);
              }
            });
          },
          child: Container(
            padding: EdgeInsets.all(isDesktop ? 12 : 16),
            child: Row(
              children: [
                Container(
                  width: isDesktop ? 32 : 40,
                  height: isDesktop ? 32 : 40,
                  decoration: BoxDecoration(
                    color: _getGradeColor(gradeValue),
                    shape: BoxShape.circle,
                  ),
                  child: Center(
                    child: Text(
                      gradeValue.toString(),
                      style: TextStyle(
                        color: Colors.white,
                        fontWeight: FontWeight.bold,
                        fontSize: isDesktop ? 14 : 16,
                      ),
                    ),
                  ),
                ),
                SizedBox(width: isDesktop ? 12 : 16),
                Expanded(
                  child: Text(
                    'Známka $gradeValue (${grades.length} žáků)',
                    style: TextStyle(
                      fontSize: isDesktop ? 14 : 16,
                      fontWeight: FontWeight.w600,
                    ),
                  ),
                ),
                AnimatedRotation(
                  turns: isExpanded ? 0.5 : 0.0,
                  duration: const Duration(milliseconds: 300),
                  child: Icon(
                    Icons.keyboard_arrow_down,
                    size: isDesktop ? 20 : 24,
                  ),
                ),
              ],
            ),
          ),
        ),
                AnimatedCrossFade(
          duration: const Duration(milliseconds: 300),
          crossFadeState: isExpanded ? CrossFadeState.showSecond : CrossFadeState.showFirst,
          firstChild: const SizedBox.shrink(),
          secondChild: Container(
            decoration: BoxDecoration(
              color: Theme.of(context).colorScheme.surface.withOpacity(0.5),
            ),
            child: Column(
              children: grades.map((grade) {
                final student = students.firstWhere((s) => s.id == grade.studentId);
                return _buildStudentGradeItem(student, grade, isDesktop);
              }).toList(),
            ),
          ),
        ),
      ],
    );
  }

  Widget _buildStudentGradeItem(Student student, Grade grade, bool isDesktop) {
    return Container(
      padding: EdgeInsets.symmetric(
        horizontal: isDesktop ? 12 : 16,
        vertical: isDesktop ? 8 : 12,
      ),
      child: Row(
        children: [
                    Container(
            width: isDesktop ? 32 : 40,
            height: isDesktop ? 32 : 40,
            decoration: BoxDecoration(
              color: Colors.blue[300],
              shape: BoxShape.circle,
            ),
            child: Center(
              child: Text(
                '${student.firstName[0]}${student.lastName[0]}',
                style: TextStyle(
                  color: Colors.white,
                  fontWeight: FontWeight.bold,
                  fontSize: isDesktop ? 11 : 13,
                ),
              ),
            ),
          ),
          SizedBox(width: isDesktop ? 12 : 16),
                    Expanded(
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  student.fullName,
                  style: TextStyle(
                    fontSize: isDesktop ? 13 : 14,
                    fontWeight: FontWeight.w600,
                  ),
                ),
                if (grade.description != null) ...[
                  const SizedBox(height: 2),
                  Text(
                    grade.description!,
                    style: TextStyle(
                      fontSize: isDesktop ? 11 : 12,
                      color: Colors.grey[600],
                    ),
                  ),
                ],
                const SizedBox(height: 2),
                Row(
                  children: [
                    Text(
                      _getGradeTypeText(grade.type),
                      style: TextStyle(
                        fontSize: isDesktop ? 10 : 11,
                        color: Theme.of(context).primaryColor,
                        fontWeight: FontWeight.w500,
                      ),
                    ),
                    Text(
                      ' • ${_formatDate(grade.date)}',
                      style: TextStyle(
                        fontSize: isDesktop ? 10 : 11,
                        color: Colors.grey[600],
                      ),
                    ),
                  ],
                ),
              ],
            ),
          ),
                    Container(
            padding: EdgeInsets.symmetric(
              horizontal: isDesktop ? 6 : 8,
              vertical: isDesktop ? 2 : 4,
            ),
            decoration: BoxDecoration(
              border: Border.all(color: Colors.grey[400]!),
              borderRadius: BorderRadius.circular(6),
            ),
            child: Text(
              'Váha: ${grade.weight.toInt()}',
              style: TextStyle(
                fontSize: isDesktop ? 9 : 10,
                fontWeight: FontWeight.w500,
              ),
            ),
          ),
        ],
      ),
    );
  }

  Color _getGradeColor(int grade) {
    switch (grade) {
      case 1: return Colors.green;
      case 2: return Colors.lightGreen;
      case 3: return Colors.orange;
      case 4: return Colors.deepOrange;
      case 5: return Colors.red;
      default: return Colors.grey;
    }
  }

  String _getGradeTypeText(GradeType type) {
    switch (type) {
      case GradeType.test: return 'Test';
      case GradeType.homework: return 'DÚ';
      case GradeType.classwork: return 'Práce v hodině';
      case GradeType.project: return 'Projekt';
      case GradeType.exam: return 'Zkouška';
    }
  }

  String _formatDate(DateTime date) {
    return '${date.day}.${date.month}.${date.year}';
  }
}


================================================================================

File: screens/teacher_classes_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../services/data_service.dart';
import '../models/data_models.dart';
import 'teacher_subject_classes_screen.dart';

class TeacherSubjectsScreen extends StatelessWidget {
  const TeacherSubjectsScreen({super.key});

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;
    final dataService = DataService();

    final currentTeacher = dataService.getCurrentTeacher();
    if (currentTeacher == null) {
      return Scaffold(
        appBar: AppBar(title: const Text('Známkování')),
        body: const Center(child: Text('Žádný učitel není přihlášen')),
      );
    }

    final teacherSubjects = dataService.getSubjectsForTeacher(currentTeacher.id);
    final teacherClasses = dataService.getClassesForTeacher(currentTeacher.id);

    return Scaffold(
      appBar: AppBar(
        title: const Text('Známkování - Výběr předmětu'),
        backgroundColor: Colors.transparent,
      ),
      body: Column(
        children: [
                    _buildTeacherInfoCard(currentTeacher, teacherClasses, isDesktop),
                    Expanded(
            child: _buildSubjectsList(context, teacherSubjects, dataService, isDesktop),
          ),
        ],
      ),
    );
  }

  Widget _buildTeacherInfoCard(Teacher teacher, List<SchoolClass> classes, bool isDesktop) {
    return Container(
      margin: EdgeInsets.all(isDesktop ? 12 : 16),
      child: Card(
        elevation: 3,
        child: Padding(
          padding: EdgeInsets.all(isDesktop ? 16 : 20),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Row(
                children: [
                  Container(
                    width: isDesktop ? 50 : 60,
                    height: isDesktop ? 50 : 60,
                    decoration: BoxDecoration(
                      color: Colors.blue,
                      borderRadius: BorderRadius.circular(isDesktop ? 25 : 30),
                    ),
                    child: Icon(
                      Icons.person_4,
                      color: Colors.white,
                      size: isDesktop ? 24 : 30,
                    ),
                  ),
                  SizedBox(width: isDesktop ? 12 : 16),
                  Expanded(
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          teacher.fullName,
                          style: TextStyle(
                            fontSize: isDesktop ? 16 : 18,
                            fontWeight: FontWeight.bold,
                          ),
                        ),
                        const SizedBox(height: 4),
                        Text(
                          'Vyberte předmět pro známkování',
                          style: TextStyle(
                            fontSize: isDesktop ? 12 : 14,
                            color: Colors.grey[600],
                          ),
                        ),
                      ],
                    ),
                  ),
                ],
              ),
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildSubjectsList(BuildContext context, List<Subject> subjects, DataService dataService, bool isDesktop) {
    if (subjects.isEmpty) {
      return const Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(Icons.book_outlined, size: 64, color: Colors.grey),
            SizedBox(height: 16),
            Text('Žádné předměty nejsou přiřazeny', style: TextStyle(fontSize: 16, color: Colors.grey)),
          ],
        ),
      );
    }

    return ListView.builder(
      padding: EdgeInsets.all(isDesktop ? 12 : 16),
      itemCount: subjects.length,
      itemBuilder: (context, index) {
        final subject = subjects[index];
        final teacherClasses = dataService.getClassesForTeacher(dataService.getCurrentTeacher()!.id);
        final classesWithGrades = teacherClasses.where((cls) {
          final grades = dataService.getGradesForClassAndSubject(cls.id, subject.id);
          return grades.isNotEmpty;
        }).toList();

        return _buildSubjectCard(context, subject, classesWithGrades, isDesktop);
      },
    );
  }

  Widget _buildSubjectCard(BuildContext context, Subject subject, List<SchoolClass> classes, bool isDesktop) {
    final totalGrades = classes.fold<int>(0, (sum, cls) {
      final grades = DataService().getGradesForClassAndSubject(cls.id, subject.id);
      return sum + grades.length;
    });

    return Card(
      margin: const EdgeInsets.only(bottom: 12),
      elevation: 2,
      child: InkWell(
        onTap: () {
          Navigator.of(context).push(
            MaterialPageRoute(
              builder: (context) => TeacherSubjectClassesScreen(subjectId: subject.id),
            ),
          );
        },
        borderRadius: BorderRadius.circular(12),
        child: Container(
          padding: EdgeInsets.all(isDesktop ? 16 : 20),
          child: Row(
            children: [
                            Container(
                width: isDesktop ? 60 : 70,
                height: isDesktop ? 60 : 70,
                decoration: BoxDecoration(
                  gradient: LinearGradient(
                    colors: [subject.color, subject.color.withOpacity(0.7)],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  ),
                  borderRadius: BorderRadius.circular(isDesktop ? 15 : 18),
                ),
                child: Center(
                  child: Text(
                    subject.shortName,
                    style: TextStyle(
                      color: Colors.white,
                      fontWeight: FontWeight.bold,
                      fontSize: isDesktop ? 16 : 20,
                    ),
                  ),
                ),
              ),
              SizedBox(width: isDesktop ? 16 : 20),
                            Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      subject.name,
                      style: TextStyle(
                        fontSize: isDesktop ? 18 : 20,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    const SizedBox(height: 4),
                    Text(
                      '${classes.length} tříd • $totalGrades známek',
                      style: TextStyle(
                        fontSize: isDesktop ? 13 : 14,
                        color: Colors.grey[600],
                      ),
                    ),
                    const SizedBox(height: 8),
                                        if (classes.isNotEmpty)
                      Text(
                        'Třídy: ${classes.map((c) => c.name).join(', ')}',
                        style: TextStyle(
                          fontSize: isDesktop ? 11 : 12,
                          color: subject.color,
                          fontWeight: FontWeight.w500,
                        ),
                      ),
                  ],
                ),
              ),
                            Icon(
                Icons.arrow_forward_ios,
                color: Colors.grey[400],
                size: isDesktop ? 16 : 20,
              ),
            ],
          ),
        ),
      ),
    );
  }
}


================================================================================

File: screens/teacher_grade_types_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../services/data_service.dart';
import '../models/data_models.dart';
import 'teacher_students_grades_screen.dart';

class TeacherGradeTypesScreen extends StatelessWidget {
  final String subjectId;
  final String classId;

  const TeacherGradeTypesScreen({
    super.key,
    required this.subjectId,
    required this.classId,
  });

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;
    final dataService = DataService();

    final subject = dataService.getSubjectById(subjectId);
    final schoolClass = dataService.getClassById(classId);

    if (subject == null || schoolClass == null) {
      return Scaffold(
        appBar: AppBar(title: const Text('Známky')),
        body: const Center(child: Text('Předmět nebo třída nenalezeny')),
      );
    }

    final grades = dataService.getGradesForClassAndSubject(classId, subjectId);

        Map<String, List<Grade>> gradeGroups = {};
    for (var grade in grades) {
      final key = '${grade.description ?? "Bez popisu"}_${grade.type.name}_${grade.date.day}/${grade.date.month}/${grade.date.year}';
      if (gradeGroups[key] == null) {
        gradeGroups[key] = [];
      }
      gradeGroups[key]!.add(grade);
    }

    return Scaffold(
      appBar: AppBar(
        title: Text('${subject.name} - ${schoolClass.name}'),
        backgroundColor: Colors.transparent,
      ),
      body: Column(
        children: [
                    _buildInfoCard(subject, schoolClass, grades, isDesktop),
                    Expanded(
            child: _buildGradeTypesList(context, gradeGroups, subject, schoolClass, isDesktop),
          ),
        ],
      ),
    );
  }

  Widget _buildInfoCard(Subject subject, SchoolClass schoolClass, List<Grade> grades, bool isDesktop) {
    final averageGrade = grades.isEmpty ? 0.0 : grades.map((g) => g.value).reduce((a, b) => a + b) / grades.length;
    final students = DataService().getStudentsForClass(classId);

    return Container(
      margin: EdgeInsets.all(isDesktop ? 12 : 16),
      child: Card(
        elevation: 3,
        child: Padding(
          padding: EdgeInsets.all(isDesktop ? 16 : 20),
          child: Row(
            children: [
              Container(
                width: isDesktop ? 50 : 60,
                height: isDesktop ? 50 : 60,
                decoration: BoxDecoration(
                  gradient: LinearGradient(
                    colors: [subject.color, subject.color.withOpacity(0.7)],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  ),
                  borderRadius: BorderRadius.circular(isDesktop ? 12 : 15),
                ),
                child: Center(
                  child: Text(
                    subject.shortName,
                    style: TextStyle(
                      color: Colors.white,
                      fontWeight: FontWeight.bold,
                      fontSize: isDesktop ? 14 : 16,
                    ),
                  ),
                ),
              ),
              SizedBox(width: isDesktop ? 12 : 16),
              Container(
                width: isDesktop ? 40 : 50,
                height: isDesktop ? 40 : 50,
                decoration: BoxDecoration(
                  gradient: const LinearGradient(
                    colors: [Colors.orange, Colors.deepOrange],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  ),
                  borderRadius: BorderRadius.circular(isDesktop ? 10 : 12),
                ),
                child: Center(
                  child: Text(
                    schoolClass.name,
                    style: TextStyle(
                      color: Colors.white,
                      fontWeight: FontWeight.bold,
                      fontSize: isDesktop ? 12 : 14,
                    ),
                  ),
                ),
              ),
              SizedBox(width: isDesktop ? 12 : 16),
              Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      '${subject.name} - ${schoolClass.name}',
                      style: TextStyle(
                        fontSize: isDesktop ? 16 : 18,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    const SizedBox(height: 4),
                    Text(
                      '${students.length} žáků • ${grades.length} známek',
                      style: TextStyle(
                        fontSize: isDesktop ? 12 : 14,
                        color: Colors.grey[600],
                      ),
                    ),
                    const SizedBox(height: 4),
                    Row(
                      children: [
                        Text(
                          'Průměr třídy: ',
                          style: TextStyle(
                            fontSize: isDesktop ? 11 : 12,
                            color: Colors.grey[600],
                          ),
                        ),
                        Container(
                          padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 2),
                          decoration: BoxDecoration(
                            color: _getGradeColor(averageGrade.round()),
                            borderRadius: BorderRadius.circular(10),
                          ),
                          child: Text(
                            averageGrade.toStringAsFixed(2),
                            style: TextStyle(
                              color: Colors.white,
                              fontSize: isDesktop ? 10 : 11,
                              fontWeight: FontWeight.bold,
                            ),
                          ),
                        ),
                      ],
                    ),
                  ],
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildGradeTypesList(BuildContext context, Map<String, List<Grade>> gradeGroups, Subject subject, SchoolClass schoolClass, bool isDesktop) {
    if (gradeGroups.isEmpty) {
      return const Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(Icons.grade_outlined, size: 64, color: Colors.grey),
            SizedBox(height: 16),
            Text('Žádné známky k zobrazení', style: TextStyle(fontSize: 16, color: Colors.grey)),
          ],
        ),
      );
    }

    final sortedEntries = gradeGroups.entries.toList()
      ..sort((a, b) => b.value.first.date.compareTo(a.value.first.date)); 
    return ListView.builder(
      padding: EdgeInsets.all(isDesktop ? 12 : 16),
      itemCount: sortedEntries.length,
      itemBuilder: (context, index) {
        final entry = sortedEntries[index];
        final grades = entry.value;
        final sampleGrade = grades.first;

        return _buildGradeTypeCard(context, sampleGrade, grades.length, subject, schoolClass, isDesktop);
      },
    );
  }

  Widget _buildGradeTypeCard(BuildContext context, Grade sampleGrade, int count, Subject subject, SchoolClass schoolClass, bool isDesktop) {
    return Card(
      margin: const EdgeInsets.only(bottom: 12),
      elevation: 2,
      child: InkWell(
        onTap: () {
          Navigator.of(context).push(
            MaterialPageRoute(
              builder: (context) => TeacherStudentsGradesScreen(
                subjectId: subject.id,
                classId: schoolClass.id,
                gradeDescription: sampleGrade.description,
                gradeType: sampleGrade.type,
                gradeDate: sampleGrade.date,
              ),
            ),
          );
        },
        borderRadius: BorderRadius.circular(12),
        child: Container(
          padding: EdgeInsets.all(isDesktop ? 16 : 20),
          child: Row(
            children: [
                            Container(
                width: isDesktop ? 50 : 60,
                height: isDesktop ? 50 : 60,
                decoration: BoxDecoration(
                  color: _getGradeTypeColor(sampleGrade.type).withOpacity(0.1),
                  border: Border.all(color: _getGradeTypeColor(sampleGrade.type), width: 2),
                  borderRadius: BorderRadius.circular(isDesktop ? 12 : 15),
                ),
                child: Icon(
                  _getGradeTypeIcon(sampleGrade.type),
                  color: _getGradeTypeColor(sampleGrade.type),
                  size: isDesktop ? 24 : 30,
                ),
              ),
              SizedBox(width: isDesktop ? 16 : 20),
                            Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      sampleGrade.description ?? 'Známka bez popisu',
                      style: TextStyle(
                        fontSize: isDesktop ? 16 : 18,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    const SizedBox(height: 4),
                    Row(
                      children: [
                        Container(
                          padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 2),
                          decoration: BoxDecoration(
                            color: _getGradeTypeColor(sampleGrade.type).withOpacity(0.2),
                            borderRadius: BorderRadius.circular(10),
                          ),
                          child: Text(
                            _getGradeTypeText(sampleGrade.type),
                            style: TextStyle(
                              color: _getGradeTypeColor(sampleGrade.type),
                              fontSize: isDesktop ? 11 : 12,
                              fontWeight: FontWeight.w600,
                            ),
                          ),
                        ),
                        const SizedBox(width: 8),
                        Text(
                          '${sampleGrade.date.day}.${sampleGrade.date.month}.${sampleGrade.date.year}',
                          style: TextStyle(
                            fontSize: isDesktop ? 11 : 12,
                            color: Colors.grey[600],
                          ),
                        ),
                      ],
                    ),
                    const SizedBox(height: 4),
                    Text(
                      '$count žáků • Váha: ${sampleGrade.weight.toInt()}',
                      style: TextStyle(
                        fontSize: isDesktop ? 11 : 12,
                        color: Colors.grey[500],
                      ),
                    ),
                  ],
                ),
              ),
                            Icon(
                Icons.arrow_forward_ios,
                color: Colors.grey[400],
                size: isDesktop ? 16 : 20,
              ),
            ],
          ),
        ),
      ),
    );
  }

  Color _getGradeColor(int grade) {
    switch (grade) {
      case 1: return Colors.green;
      case 2: return Colors.lightGreen;
      case 3: return Colors.orange;
      case 4: return Colors.deepOrange;
      case 5: return Colors.red;
      default: return Colors.grey;
    }
  }

  Color _getGradeTypeColor(GradeType type) {
    switch (type) {
      case GradeType.test: return Colors.red;
      case GradeType.homework: return Colors.blue;
      case GradeType.classwork: return Colors.green;
      case GradeType.project: return Colors.purple;
      case GradeType.exam: return Colors.orange;
    }
  }

  IconData _getGradeTypeIcon(GradeType type) {
    switch (type) {
      case GradeType.test: return Icons.quiz;
      case GradeType.homework: return Icons.assignment;
      case GradeType.classwork: return Icons.school;
      case GradeType.project: return Icons.work;
      case GradeType.exam: return Icons.assignment_turned_in;
    }
  }

  String _getGradeTypeText(GradeType type) {
    switch (type) {
      case GradeType.test: return 'Test';
      case GradeType.homework: return 'DÚ';
      case GradeType.classwork: return 'Práce v hodině';
      case GradeType.project: return 'Projekt';
      case GradeType.exam: return 'Zkouška';
    }
  }
}


================================================================================

File: screens/teacher_students_grades_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../services/data_service.dart';
import '../models/data_models.dart';

class TeacherStudentsGradesScreen extends StatelessWidget {
  final String subjectId;
  final String classId;
  final String? gradeDescription;
  final GradeType gradeType;
  final DateTime gradeDate;

  const TeacherStudentsGradesScreen({
    super.key,
    required this.subjectId,
    required this.classId,
    required this.gradeDescription,
    required this.gradeType,
    required this.gradeDate,
  });

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;
    final dataService = DataService();

    final subject = dataService.getSubjectById(subjectId);
    final schoolClass = dataService.getClassById(classId);

    if (subject == null || schoolClass == null) {
      return Scaffold(
        appBar: AppBar(title: const Text('Žáci a známky')),
        body: const Center(child: Text('Předmět nebo třída nenalezeny')),
      );
    }

    final allGrades = dataService.getGradesForClassAndSubject(classId, subjectId);
    final filteredGrades = allGrades.where((grade) =>
    grade.description == gradeDescription &&
        grade.type == gradeType &&
        grade.date.day == gradeDate.day &&
        grade.date.month == gradeDate.month &&
        grade.date.year == gradeDate.year
    ).toList();

    final students = dataService.getStudentsForClass(classId);

    return Scaffold(
      appBar: AppBar(
        title: Text('${subject.shortName} - ${schoolClass.name}'),
        backgroundColor: Colors.transparent,
      ),
      body: Column(
        children: [
                    _buildGradeInfoCard(subject, schoolClass, filteredGrades, isDesktop),
                    Expanded(
            child: _buildStudentsList(filteredGrades, students, isDesktop),
          ),
        ],
      ),
    );
  }

  Widget _buildGradeInfoCard(Subject subject, SchoolClass schoolClass, List<Grade> grades, bool isDesktop) {
    final averageGrade = grades.isEmpty ? 0.0 : grades.map((g) => g.value).reduce((a, b) => a + b) / grades.length;
    final gradeDistribution = <int, int>{};
    for (var grade in grades) {
      gradeDistribution[grade.value] = (gradeDistribution[grade.value] ?? 0) + 1;
    }

    return Container(
      margin: EdgeInsets.all(isDesktop ? 12 : 16),
      child: Card(
        elevation: 3,
        child: Padding(
          padding: EdgeInsets.all(isDesktop ? 16 : 20),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Row(
                children: [
                  Container(
                    width: isDesktop ? 40 : 50,
                    height: isDesktop ? 40 : 50,
                    decoration: BoxDecoration(
                      gradient: LinearGradient(
                        colors: [subject.color, subject.color.withOpacity(0.7)],
                        begin: Alignment.topLeft,
                        end: Alignment.bottomRight,
                      ),
                      borderRadius: BorderRadius.circular(isDesktop ? 10 : 12),
                    ),
                    child: Center(
                      child: Text(
                        subject.shortName,
                        style: TextStyle(
                          color: Colors.white,
                          fontWeight: FontWeight.bold,
                          fontSize: isDesktop ? 12 : 14,
                        ),
                      ),
                    ),
                  ),
                  SizedBox(width: isDesktop ? 12 : 16),
                  Container(
                    width: isDesktop ? 40 : 50,
                    height: isDesktop ? 40 : 50,
                    decoration: BoxDecoration(
                      color: _getGradeTypeColor(gradeType).withOpacity(0.1),
                      border: Border.all(color: _getGradeTypeColor(gradeType), width: 2),
                      borderRadius: BorderRadius.circular(isDesktop ? 10 : 12),
                    ),
                    child: Icon(
                      _getGradeTypeIcon(gradeType),
                      color: _getGradeTypeColor(gradeType),
                      size: isDesktop ? 18 : 22,
                    ),
                  ),
                  SizedBox(width: isDesktop ? 12 : 16),
                  Expanded(
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          gradeDescription ?? 'Známka bez popisu',
                          style: TextStyle(
                            fontSize: isDesktop ? 16 : 18,
                            fontWeight: FontWeight.bold,
                          ),
                        ),
                        const SizedBox(height: 2),
                        Row(
                          children: [
                            Container(
                              padding: const EdgeInsets.symmetric(horizontal: 6, vertical: 2),
                              decoration: BoxDecoration(
                                color: _getGradeTypeColor(gradeType).withOpacity(0.2),
                                borderRadius: BorderRadius.circular(8),
                              ),
                              child: Text(
                                _getGradeTypeText(gradeType),
                                style: TextStyle(
                                  color: _getGradeTypeColor(gradeType),
                                  fontSize: isDesktop ? 10 : 11,
                                  fontWeight: FontWeight.w600,
                                ),
                              ),
                            ),
                            const SizedBox(width: 8),
                            Text(
                              '${gradeDate.day}.${gradeDate.month}.${gradeDate.year}',
                              style: TextStyle(
                                fontSize: isDesktop ? 11 : 12,
                                color: Colors.grey[600],
                              ),
                            ),
                          ],
                        ),
                      ],
                    ),
                  ),
                ],
              ),
              const SizedBox(height: 16),
                            Row(
                mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                children: [
                  _buildStatColumn('Průměr', averageGrade.toStringAsFixed(2), _getGradeColor(averageGrade.round())),
                  _buildStatColumn('Celkem', grades.length.toString(), Colors.blue),
                  _buildStatColumn('Nejlepší', grades.isEmpty ? '0' : grades.map((g) => g.value).reduce((a, b) => a < b ? a : b).toString(), Colors.green),
                ],
              ),
              const SizedBox(height: 12),
                            if (grades.isNotEmpty) ...[
                Text(
                  'Rozložení známek:',
                  style: TextStyle(
                    fontSize: isDesktop ? 13 : 14,
                    fontWeight: FontWeight.w600,
                  ),
                ),
                const SizedBox(height: 8),
                Row(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: [1, 2, 3, 4, 5].map((grade) {
                    final count = gradeDistribution[grade] ?? 0;
                    return Column(
                      children: [
                        Container(
                          width: isDesktop ? 24 : 28,
                          height: isDesktop ? 24 : 28,
                          decoration: BoxDecoration(
                            color: _getGradeColor(grade),
                            shape: BoxShape.circle,
                          ),
                          child: Center(
                            child: Text(
                              grade.toString(),
                              style: TextStyle(
                                color: Colors.white,
                                fontWeight: FontWeight.bold,
                                fontSize: isDesktop ? 11 : 12,
                              ),
                            ),
                          ),
                        ),
                        const SizedBox(height: 4),
                        Text(
                          count.toString(),
                          style: TextStyle(
                            fontSize: isDesktop ? 10 : 11,
                            fontWeight: FontWeight.w500,
                          ),
                        ),
                      ],
                    );
                  }).toList(),
                ),
              ],
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildStatColumn(String label, String value, Color color) {
    return Column(
      children: [
        Container(
          width: 40,
          height: 40,
          decoration: BoxDecoration(
            color: color,
            borderRadius: BorderRadius.circular(20),
          ),
          child: Center(
            child: Text(
              value,
              style: const TextStyle(
                color: Colors.white,
                fontSize: 12,
                fontWeight: FontWeight.bold,
              ),
            ),
          ),
        ),
        const SizedBox(height: 4),
        Text(
          label,
          style: const TextStyle(fontSize: 10, fontWeight: FontWeight.w500),
        ),
      ],
    );
  }

  Widget _buildStudentsList(List<Grade> grades, List<Student> allStudents, bool isDesktop) {
    if (grades.isEmpty) {
      return const Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(Icons.people_outline, size: 64, color: Colors.grey),
            SizedBox(height: 16),
            Text('Žádní žáci s touto známkou', style: TextStyle(fontSize: 16, color: Colors.grey)),
          ],
        ),
      );
    }

        grades.sort((a, b) => a.value.compareTo(b.value));

    return ListView.builder(
      padding: EdgeInsets.all(isDesktop ? 12 : 16),
      itemCount: grades.length,
      itemBuilder: (context, index) {
        final grade = grades[index];
        final student = allStudents.firstWhere((s) => s.id == grade.studentId);

        return _buildStudentGradeCard(student, grade, index + 1, isDesktop);
      },
    );
  }

  Widget _buildStudentGradeCard(Student student, Grade grade, int rank, bool isDesktop) {
    return Card(
      margin: const EdgeInsets.only(bottom: 8),
      elevation: 1,
      child: Container(
        padding: EdgeInsets.all(isDesktop ? 12 : 16),
        child: Row(
          children: [
                        Container(
              width: isDesktop ? 30 : 35,
              height: isDesktop ? 30 : 35,
              decoration: BoxDecoration(
                color: rank <= 3 ? Colors.amber : Colors.grey[300],
                shape: BoxShape.circle,
              ),
              child: Center(
                child: Text(
                  rank.toString(),
                  style: TextStyle(
                    color: rank <= 3 ? Colors.white : Colors.grey[700],
                    fontWeight: FontWeight.bold,
                    fontSize: isDesktop ? 12 : 13,
                  ),
                ),
              ),
            ),
            SizedBox(width: isDesktop ? 12 : 16),
                        Container(
              width: isDesktop ? 40 : 50,
              height: isDesktop ? 40 : 50,
              decoration: BoxDecoration(
                color: Colors.blue[300],
                shape: BoxShape.circle,
              ),
              child: Center(
                child: Text(
                  '${student.firstName[0]}${student.lastName[0]}',
                  style: TextStyle(
                    color: Colors.white,
                    fontWeight: FontWeight.bold,
                    fontSize: isDesktop ? 14 : 16,
                  ),
                ),
              ),
            ),
            SizedBox(width: isDesktop ? 12 : 16),
                        Expanded(
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(
                    student.fullName,
                    style: TextStyle(
                      fontSize: isDesktop ? 14 : 16,
                      fontWeight: FontWeight.w600,
                    ),
                  ),
                  const SizedBox(height: 2),
                  Text(
                    'Váha: ${grade.weight.toInt()}',
                    style: TextStyle(
                      fontSize: isDesktop ? 11 : 12,
                      color: Colors.grey[600],
                    ),
                  ),
                ],
              ),
            ),
                        Container(
              width: isDesktop ? 40 : 50,
              height: isDesktop ? 40 : 50,
              decoration: BoxDecoration(
                color: _getGradeColor(grade.value),
                shape: BoxShape.circle,
              ),
              child: Center(
                child: Text(
                  grade.value.toString(),
                  style: TextStyle(
                    color: Colors.white,
                    fontWeight: FontWeight.bold,
                    fontSize: isDesktop ? 16 : 18,
                  ),
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }

  Color _getGradeColor(int grade) {
    switch (grade) {
      case 1: return Colors.green;
      case 2: return Colors.lightGreen;
      case 3: return Colors.orange;
      case 4: return Colors.deepOrange;
      case 5: return Colors.red;
      default: return Colors.grey;
    }
  }

  Color _getGradeTypeColor(GradeType type) {
    switch (type) {
      case GradeType.test: return Colors.red;
      case GradeType.homework: return Colors.blue;
      case GradeType.classwork: return Colors.green;
      case GradeType.project: return Colors.purple;
      case GradeType.exam: return Colors.orange;
    }
  }

  IconData _getGradeTypeIcon(GradeType type) {
    switch (type) {
      case GradeType.test: return Icons.quiz;
      case GradeType.homework: return Icons.assignment;
      case GradeType.classwork: return Icons.school;
      case GradeType.project: return Icons.work;
      case GradeType.exam: return Icons.assignment_turned_in;
    }
  }

  String _getGradeTypeText(GradeType type) {
    switch (type) {
      case GradeType.test: return 'Test';
      case GradeType.homework: return 'DÚ';
      case GradeType.classwork: return 'Práce v hodině';
      case GradeType.project: return 'Projekt';
      case GradeType.exam: return 'Zkouška';
    }
  }
}


================================================================================

File: screens/teacher_subject_classes_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../services/data_service.dart';
import '../models/data_models.dart';
import 'teacher_grade_types_screen.dart';

class TeacherSubjectClassesScreen extends StatelessWidget {
  final String subjectId;

  const TeacherSubjectClassesScreen({super.key, required this.subjectId});

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;
    final dataService = DataService();

    final subject = dataService.getSubjectById(subjectId);
    final currentTeacher = dataService.getCurrentTeacher();

    if (subject == null || currentTeacher == null) {
      return Scaffold(
        appBar: AppBar(title: const Text('Třídy')),
        body: const Center(child: Text('Předmět nenalezen')),
      );
    }

    final teacherClasses = dataService.getClassesForTeacher(currentTeacher.id);
    final classesWithGrades = teacherClasses.where((cls) {
      final grades = dataService.getGradesForClassAndSubject(cls.id, subject.id);
      return grades.isNotEmpty;
    }).toList();

    return Scaffold(
      appBar: AppBar(
        title: Text('${subject.name} - Výběr třídy'),
        backgroundColor: Colors.transparent,
      ),
      body: Column(
        children: [
                    _buildSubjectInfoCard(subject, classesWithGrades, isDesktop),
                    Expanded(
            child: _buildClassesList(context, classesWithGrades, subject, dataService, isDesktop),
          ),
        ],
      ),
    );
  }

  Widget _buildSubjectInfoCard(Subject subject, List<SchoolClass> classes, bool isDesktop) {
    final totalGrades = classes.fold<int>(0, (sum, cls) {
      final grades = DataService().getGradesForClassAndSubject(cls.id, subject.id);
      return sum + grades.length;
    });

    return Container(
      margin: EdgeInsets.all(isDesktop ? 12 : 16),
      child: Card(
        elevation: 3,
        child: Padding(
          padding: EdgeInsets.all(isDesktop ? 16 : 20),
          child: Row(
            children: [
              Container(
                width: isDesktop ? 60 : 70,
                height: isDesktop ? 60 : 70,
                decoration: BoxDecoration(
                  gradient: LinearGradient(
                    colors: [subject.color, subject.color.withOpacity(0.7)],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  ),
                  borderRadius: BorderRadius.circular(isDesktop ? 15 : 18),
                ),
                child: Center(
                  child: Text(
                    subject.shortName,
                    style: TextStyle(
                      color: Colors.white,
                      fontWeight: FontWeight.bold,
                      fontSize: isDesktop ? 16 : 20,
                    ),
                  ),
                ),
              ),
              SizedBox(width: isDesktop ? 16 : 20),
              Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      subject.name,
                      style: TextStyle(
                        fontSize: isDesktop ? 18 : 20,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    const SizedBox(height: 4),
                    Text(
                      'Vyberte třídu pro zobrazení známek',
                      style: TextStyle(
                        fontSize: isDesktop ? 13 : 14,
                        color: Colors.grey[600],
                      ),
                    ),
                    const SizedBox(height: 4),
                    Text(
                      '${classes.length} tříd • $totalGrades známek celkem',
                      style: TextStyle(
                        fontSize: isDesktop ? 11 : 12,
                        color: subject.color,
                        fontWeight: FontWeight.w500,
                      ),
                    ),
                  ],
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildClassesList(BuildContext context, List<SchoolClass> classes, Subject subject, DataService dataService, bool isDesktop) {
    if (classes.isEmpty) {
      return Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(Icons.class_outlined, size: 64, color: Colors.grey),
            const SizedBox(height: 16),
            Text(
              'Žádné třídy s známkami z ${subject.name}',
              style: const TextStyle(fontSize: 16, color: Colors.grey),
            ),
          ],
        ),
      );
    }

    return ListView.builder(
      padding: EdgeInsets.all(isDesktop ? 12 : 16),
      itemCount: classes.length,
      itemBuilder: (context, index) {
        final schoolClass = classes[index];
        final students = dataService.getStudentsForClass(schoolClass.id);
        final grades = dataService.getGradesForClassAndSubject(schoolClass.id, subject.id);

        return _buildClassCard(context, schoolClass, students, grades, subject, isDesktop);
      },
    );
  }

  Widget _buildClassCard(BuildContext context, SchoolClass schoolClass, List<Student> students, List<Grade> grades, Subject subject, bool isDesktop) {
    final averageGrade = grades.isEmpty ? 0.0 : grades.map((g) => g.value).reduce((a, b) => a + b) / grades.length;

    return Card(
      margin: const EdgeInsets.only(bottom: 12),
      elevation: 2,
      child: InkWell(
        onTap: () {
          Navigator.of(context).push(
            MaterialPageRoute(
              builder: (context) => TeacherGradeTypesScreen(
                subjectId: subject.id,
                classId: schoolClass.id,
              ),
            ),
          );
        },
        borderRadius: BorderRadius.circular(12),
        child: Container(
          padding: EdgeInsets.all(isDesktop ? 16 : 20),
          child: Row(
            children: [
                            Container(
                width: isDesktop ? 50 : 60,
                height: isDesktop ? 50 : 60,
                decoration: BoxDecoration(
                  gradient: const LinearGradient(
                    colors: [Colors.orange, Colors.deepOrange],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  ),
                  borderRadius: BorderRadius.circular(isDesktop ? 12 : 15),
                ),
                child: Center(
                  child: Text(
                    schoolClass.name,
                    style: TextStyle(
                      color: Colors.white,
                      fontWeight: FontWeight.bold,
                      fontSize: isDesktop ? 14 : 16,
                    ),
                  ),
                ),
              ),
              SizedBox(width: isDesktop ? 16 : 20),
                            Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      'Třída ${schoolClass.name}',
                      style: TextStyle(
                        fontSize: isDesktop ? 16 : 18,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    const SizedBox(height: 4),
                    Text(
                      '${students.length} žáků • ${grades.length} známek',
                      style: TextStyle(
                        fontSize: isDesktop ? 12 : 14,
                        color: Colors.grey[600],
                      ),
                    ),
                    const SizedBox(height: 4),
                    Row(
                      children: [
                        Text(
                          'Průměr: ',
                          style: TextStyle(
                            fontSize: isDesktop ? 11 : 12,
                            color: Colors.grey[600],
                          ),
                        ),
                        Container(
                          padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 2),
                          decoration: BoxDecoration(
                            color: _getGradeColor(averageGrade.round()),
                            borderRadius: BorderRadius.circular(10),
                          ),
                          child: Text(
                            averageGrade.toStringAsFixed(1),
                            style: TextStyle(
                              color: Colors.white,
                              fontSize: isDesktop ? 10 : 11,
                              fontWeight: FontWeight.bold,
                            ),
                          ),
                        ),
                      ],
                    ),
                  ],
                ),
              ),
                            Icon(
                Icons.arrow_forward_ios,
                color: Colors.grey[400],
                size: isDesktop ? 16 : 20,
              ),
            ],
          ),
        ),
      ),
    );
  }

  Color _getGradeColor(int grade) {
    switch (grade) {
      case 1: return Colors.green;
      case 2: return Colors.lightGreen;
      case 3: return Colors.orange;
      case 4: return Colors.deepOrange;
      case 5: return Colors.red;
      default: return Colors.grey;
    }
  }
}


================================================================================

File: screens/teacher_timetable_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../services/data_service.dart';
import '../models/data_models.dart';
import '../theme/app_theme.dart';

class TeacherTimetableScreen extends StatefulWidget {
  const TeacherTimetableScreen({super.key});

  @override
  State<TeacherTimetableScreen> createState() => _TeacherTimetableScreenState();
}

class _TeacherTimetableScreenState extends State<TeacherTimetableScreen> {
  final DataService _dataService = DataService();

  final List<String> _dayNames = [
    'Po',
    'Út',
    'St',
    'Čt',
    'Pá',
  ];

  final List<String> _fullDayNames = [
    'Pondělí',
    'Úterý',
    'Středa',
    'Čtvrtek',
    'Pátek',
  ];

  final List<Map<String, String>> _timeSlots = [
    {'period': '1', 'start': '7:05', 'end': '7:50'},
    {'period': '2', 'start': '8:00', 'end': '8:45'},
    {'period': '3', 'start': '8:55', 'end': '9:40'},
    {'period': '4', 'start': '9:55', 'end': '10:40'},
    {'period': '5', 'start': '10:50', 'end': '11:35'},
    {'period': '6', 'start': '11:45', 'end': '12:30'},
    {'period': '7', 'start': '12:40', 'end': '13:25'},
    {'period': '8', 'start': '13:35', 'end': '14:20'},
  ];

  TimetableEntry? _selectedEntry;

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;

    final currentTeacher = _dataService.getCurrentTeacher();
    if (currentTeacher == null) {
      return Scaffold(
        backgroundColor: Colors.transparent,
        appBar: AppBar(
          title: const Text('Rozvrh'),
          backgroundColor: Colors.transparent,
        ),
        body: const Center(child: Text('Žádný učitel není přihlášen')),
      );
    }

    final timetable = _dataService.getTimetableForTeacher(currentTeacher.id);

    return Scaffold(
      backgroundColor: Colors.transparent,
      appBar: AppBar(
        title: const Text('Můj rozvrh'),
        backgroundColor: Colors.transparent,
        actions: [
          IconButton(
            icon: const Icon(Icons.info_outline),
            onPressed: () => _showInfoDialog(context),
          ),
        ],
      ),
      body: Align(
        alignment: Alignment.topCenter,
        child: SingleChildScrollView(
          child: ConstrainedBox(
            constraints: const BoxConstraints(
              maxWidth: 1400,
            ),
            child: _buildTimetableView(timetable, screenWidth),
          ),
        ),
      ),
    );
  }

  Widget _buildTimetableView(
      List<TimetableEntry> timetable,
      double screenWidth,
      ) {
    final isDesktop = screenWidth > 800;
    final effectiveWidth = screenWidth > 1400 ? 1400.0 : screenWidth;

    final dayColumnWidth = isDesktop ? 70.0 : 50.0;
    final outerMargin = isDesktop ? 16.0 : 12.0;
    final innerPadding = isDesktop ? 20.0 : 12.0;
    final cellMargin = 2.0;

    final totalHorizontalSpace = (outerMargin * 2) +
        (innerPadding * 2) +
        dayColumnWidth +
        (cellMargin * 2 * _timeSlots.length);

    final availableWidth = effectiveWidth - totalHorizontalSpace;
    final cellWidth = availableWidth / _timeSlots.length;
    final cellHeight = isDesktop ? 85.0 : 70.0;

    return Container(
      width: effectiveWidth,
      margin: EdgeInsets.all(outerMargin),
      child: AppTheme.glass(
        borderRadius: isDesktop ? 20 : 18,
        padding: EdgeInsets.all(innerPadding),
        color: Colors.white.withOpacity(0.08),
        child: _buildTimetableGrid(
          timetable,
          cellWidth,
          cellHeight,
          dayColumnWidth,
          isDesktop,
        ),
      ),
    );
  }

  Widget _buildTimetableGrid(
      List<TimetableEntry> timetable,
      double cellWidth,
      double cellHeight,
      double dayColumnWidth,
      bool isDesktop,
      ) {
    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      mainAxisSize: MainAxisSize.min,
      children: [
                Row(
          mainAxisSize: MainAxisSize.min,
          children: [
            SizedBox(
              width: dayColumnWidth,
              height: isDesktop ? 60 : 50,
            ),
            ...List.generate(_timeSlots.length, (index) {
              final timeSlot = _timeSlots[index];
              return Container(
                width: cellWidth,
                height: isDesktop ? 60 : 50,
                margin: const EdgeInsets.all(2),
                decoration: BoxDecoration(
                  color: Colors.white.withOpacity(0.1),
                  borderRadius: BorderRadius.circular(8),
                ),
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    Text(
                      timeSlot['period']!,
                      style: TextStyle(
                        color: Colors.white,
                        fontWeight: FontWeight.bold,
                        fontSize: isDesktop ? 16 : 14,
                      ),
                    ),
                    const SizedBox(height: 2),
                    Text(
                      timeSlot['start']!,
                      style: TextStyle(
                        color: Colors.grey[400],
                        fontSize: isDesktop ? 10 : 9,
                      ),
                    ),
                    Text(
                      timeSlot['end']!,
                      style: TextStyle(
                        color: Colors.grey[400],
                        fontSize: isDesktop ? 10 : 9,
                      ),
                    ),
                  ],
                ),
              );
            }),
          ],
        ),
                ...List.generate(5, (dayIndex) {
          final dayOfWeek = dayIndex + 1;
          final isToday = DateTime.now().weekday == dayOfWeek;

          return Row(
            mainAxisSize: MainAxisSize.min,
            children: [
                            Container(
                width: dayColumnWidth,
                height: cellHeight,
                margin: const EdgeInsets.all(2),
                decoration: BoxDecoration(
                  gradient: isToday
                      ? const LinearGradient(
                    colors: [Color(0xFFFF9800), Color(0xFFFF5722)],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  )
                      : null,
                  color: isToday ? null : Colors.white.withOpacity(0.1),
                  borderRadius: BorderRadius.circular(8),
                ),
                child: Center(
                  child: Column(
                    mainAxisAlignment: MainAxisAlignment.center,
                    children: [
                      Text(
                        _dayNames[dayIndex],
                        style: TextStyle(
                          color: Colors.white,
                          fontWeight: FontWeight.bold,
                          fontSize: isDesktop ? 16 : 14,
                        ),
                      ),
                      if (isToday)
                        Container(
                          margin: const EdgeInsets.only(top: 2),
                          width: 4,
                          height: 4,
                          decoration: const BoxDecoration(
                            color: Colors.white,
                            shape: BoxShape.circle,
                          ),
                        ),
                    ],
                  ),
                ),
              ),
                            ...List.generate(_timeSlots.length, (periodIndex) {
                final period = periodIndex + 1;
                final entry = timetable.firstWhere(
                      (e) => e.dayOfWeek == dayOfWeek && e.period == period,
                  orElse: () => TimetableEntry(
                    id: 'empty',
                    subjectId: '',
                    teacherId: '',
                    classId: '',
                    room: '',
                    dayOfWeek: dayOfWeek,
                    period: period,
                    startTime: DateTime.now(),
                    endTime: DateTime.now(),
                  ),
                );

                return _buildTimetableCell(
                  entry,
                  cellWidth,
                  cellHeight,
                  isDesktop,
                );
              }),
            ],
          );
        }),
      ],
    );
  }

  Widget _buildTimetableCell(
      TimetableEntry entry,
      double width,
      double height,
      bool isDesktop,
      ) {
    if (entry.id == 'empty') {
      return Container(
        width: width,
        height: height,
        margin: const EdgeInsets.all(2),
        decoration: BoxDecoration(
          color: Colors.white.withOpacity(0.03),
          borderRadius: BorderRadius.circular(8),
          border: Border.all(
            color: Colors.white.withOpacity(0.1),
            width: 1,
          ),
        ),
      );
    }

    final subject = _dataService.getSubjectById(entry.subjectId);
    final schoolClass = _dataService.getClassById(entry.classId);

    if (subject == null) {
      return Container(
        width: width,
        height: height,
        margin: const EdgeInsets.all(2),
      );
    }

    final isSelected = _selectedEntry?.id == entry.id;

    return GestureDetector(
      onTap: () => _showLessonDetail(entry, subject, schoolClass),
      child: MouseRegion(
        cursor: SystemMouseCursors.click,
        onEnter: (_) => setState(() => _selectedEntry = entry),
        onExit: (_) => setState(() => _selectedEntry = null),
        child: AnimatedContainer(
          duration: const Duration(milliseconds: 200),
          width: width,
          height: height,
          margin: const EdgeInsets.all(2),
          decoration: BoxDecoration(
            gradient: LinearGradient(
              colors: [
                subject.color,
                subject.color.withOpacity(0.7),
              ],
              begin: Alignment.topLeft,
              end: Alignment.bottomRight,
            ),
            borderRadius: BorderRadius.circular(8),
            border: Border.all(
              color: isSelected ? Colors.white : subject.color.withOpacity(0.5),
              width: isSelected ? 2 : 1,
            ),
            boxShadow: isSelected
                ? [
              BoxShadow(
                color: subject.color.withOpacity(0.5),
                blurRadius: 12,
                offset: const Offset(0, 4),
              ),
            ]
                : null,
          ),
          child: Padding(
            padding: EdgeInsets.all(isDesktop ? 8 : 6),
            child: Column(
              mainAxisAlignment: MainAxisAlignment.center,
              crossAxisAlignment: CrossAxisAlignment.center,
              children: [
                Text(
                  subject.shortName,
                  style: TextStyle(
                    color: Colors.white,
                    fontWeight: FontWeight.bold,
                    fontSize: isDesktop ? 15 : 13,
                  ),
                  textAlign: TextAlign.center,
                  maxLines: 1,
                  overflow: TextOverflow.ellipsis,
                ),
                const SizedBox(height: 2),
                Text(
                  schoolClass?.name ?? '',
                  style: TextStyle(
                    color: Colors.white.withOpacity(0.9),
                    fontSize: isDesktop ? 11 : 9,
                    fontWeight: FontWeight.w600,
                  ),
                  textAlign: TextAlign.center,
                  maxLines: 1,
                  overflow: TextOverflow.ellipsis,
                ),
                const SizedBox(height: 2),
                Text(
                  entry.room,
                  style: TextStyle(
                    color: Colors.white.withOpacity(0.8),
                    fontSize: isDesktop ? 10 : 8,
                  ),
                  textAlign: TextAlign.center,
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }

  void _showLessonDetail(
      TimetableEntry entry,
      Subject subject,
      SchoolClass? schoolClass,
      ) {
    final startTime =
        '${entry.startTime.hour.toString().padLeft(2, '0')}:${entry.startTime.minute.toString().padLeft(2, '0')}';
    final endTime =
        '${entry.endTime.hour.toString().padLeft(2, '0')}:${entry.endTime.minute.toString().padLeft(2, '0')}';

    final students = schoolClass != null
        ? _dataService.getStudentsForClass(schoolClass.id)
        : <Student>[];

    showDialog(
      context: context,
      builder: (BuildContext context) {
        return AlertDialog(
          title: Row(
            children: [
              Container(
                width: 40,
                height: 40,
                decoration: BoxDecoration(
                  gradient: LinearGradient(
                    colors: [subject.color, subject.color.withOpacity(0.7)],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  ),
                  borderRadius: BorderRadius.circular(8),
                ),
                child: Center(
                  child: Text(
                    subject.shortName,
                    style: const TextStyle(
                      color: Colors.white,
                      fontWeight: FontWeight.bold,
                      fontSize: 14,
                    ),
                  ),
                ),
              ),
              const SizedBox(width: 12),
              Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      subject.name,
                      style: const TextStyle(fontSize: 18),
                    ),
                    Text(
                      '${_fullDayNames[entry.dayOfWeek - 1]} | ${entry.period}. hodina',
                      style: TextStyle(
                        fontSize: 12,
                        color: Colors.grey[600],
                        fontWeight: FontWeight.normal,
                      ),
                    ),
                  ],
                ),
              ),
            ],
          ),
          content: SingleChildScrollView(
            child: Column(
              mainAxisSize: MainAxisSize.min,
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                _buildDetailRow(Icons.access_time, 'Čas', '$startTime - $endTime'),
                const SizedBox(height: 12),
                _buildDetailRow(
                  Icons.class_outlined,
                  'Třída',
                  schoolClass?.name ?? 'Neznámá',
                ),
                const SizedBox(height: 12),
                _buildDetailRow(Icons.room_outlined, 'Místnost', entry.room),
                const SizedBox(height: 12),
                _buildDetailRow(
                  Icons.event_outlined,
                  'Den',
                  _fullDayNames[entry.dayOfWeek - 1],
                ),
                if (students.isNotEmpty) ...[
                  const SizedBox(height: 16),
                  const Divider(),
                  const SizedBox(height: 8),
                  Text(
                    'Studenti (${students.length})',
                    style: const TextStyle(
                      fontWeight: FontWeight.bold,
                      fontSize: 14,
                    ),
                  ),
                  const SizedBox(height: 8),
                  ...students.map((student) => Padding(
                    padding: const EdgeInsets.symmetric(vertical: 2),
                    child: Row(
                      children: [
                        const Icon(Icons.person_outline, size: 16),
                        const SizedBox(width: 8),
                        Text(student.fullName),
                      ],
                    ),
                  )),
                ],
              ],
            ),
          ),
          actions: [
            TextButton(
              onPressed: () => Navigator.of(context).pop(),
              child: const Text('Zavřít'),
            ),
          ],
        );
      },
    );
  }

  Widget _buildDetailRow(IconData icon, String label, String value) {
    return Row(
      children: [
        Icon(icon, size: 20, color: Colors.grey[600]),
        const SizedBox(width: 8),
        Text(
          '$label: ',
          style: const TextStyle(fontWeight: FontWeight.bold),
        ),
        Expanded(
          child: Text(value),
        ),
      ],
    );
  }

  void _showInfoDialog(BuildContext context) {
    showDialog(
      context: context,
      builder: (BuildContext context) {
        return const AlertDialog(
          title: Text('O rozvrhu'),
          content: Column(
            mainAxisSize: MainAxisSize.min,
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Text('Zobrazení vašeho týdenního rozvrhu výuky.'),
              SizedBox(height: 12),
              Text('• Kliknutím na hodinu zobrazíte detaily a seznam žáků'),
              Text('• Aktuální den je zvýrazněn oranžově'),
              Text('• Barvy odpovídají jednotlivým předmětům'),
            ],
          ),
        );
      },
    );
  }
}


================================================================================

File: screens/timetable_screen.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../services/data_service.dart';
import '../models/data_models.dart';
import '../theme/app_theme.dart';

class TimetableScreen extends StatefulWidget {
  const TimetableScreen({super.key});

  @override
  State<TimetableScreen> createState() => _TimetableScreenState();
}

class _TimetableScreenState extends State<TimetableScreen> {
  final DataService _dataService = DataService();

  final List<String> _dayNames = ['Po', 'Út', 'St', 'Čt', 'Pá'];
  final List<String> _fullDayNames = [
    'Pondělí',
    'Úterý',
    'Středa',
    'Čtvrtek',
    'Pátek',
  ];

  final List<Map<String, String>> _timeSlots = [
    {'period': '1', 'start': '7:05', 'end': '7:50'},
    {'period': '2', 'start': '8:00', 'end': '8:45'},
    {'period': '3', 'start': '8:55', 'end': '9:40'},
    {'period': '4', 'start': '9:55', 'end': '10:40'},
    {'period': '5', 'start': '10:50', 'end': '11:35'},
    {'period': '6', 'start': '11:45', 'end': '12:30'},
    {'period': '7', 'start': '12:40', 'end': '13:25'},
    {'period': '8', 'start': '13:35', 'end': '14:20'},
  ];

  TimetableEntry? _selectedEntry;

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final currentStudent = _dataService.getCurrentStudent();

    if (currentStudent == null) {
      return Scaffold(
        backgroundColor: Colors.transparent,
        appBar: AppBar(
          title: const Text('Rozvrh'),
          backgroundColor: Colors.transparent,
        ),
        body: const Center(child: Text('Žádný student není přihlášen')),
      );
    }

    final timetable = _dataService.getTimetableForClass(currentStudent.classId);
    final isDesktop = screenWidth > 800;

    return Scaffold(
      backgroundColor: Colors.transparent,
      appBar: AppBar(
        title: const Text('Rozvrh'),
        backgroundColor: Colors.transparent,
        actions: [
          IconButton(
            icon: const Icon(Icons.info_outline),
            onPressed: () => _showInfoDialog(context),
          ),
        ],
      ),
      body: isDesktop
          ? _buildDesktopView(timetable, screenWidth)
          : _buildMobileView(timetable),
    );
  }

  // Desktop view - original grid layout
  Widget _buildDesktopView(List<TimetableEntry> timetable, double screenWidth) {
    final effectiveWidth = screenWidth > 1400 ? 1400.0 : screenWidth;
    final dayColumnWidth = 70.0;
    final outerMargin = 16.0;
    final innerPadding = 20.0;
    final cellMargin = 2.0;

    final totalHorizontalSpace = (outerMargin * 2) +
        (innerPadding * 2) +
        dayColumnWidth +
        (cellMargin * 2 * _timeSlots.length);

    final availableWidth = effectiveWidth - totalHorizontalSpace;
    final cellWidth = availableWidth / _timeSlots.length;
    final cellHeight = 85.0;

    return Align(
      alignment: Alignment.topCenter,
      child: SingleChildScrollView(
        child: ConstrainedBox(
          constraints: const BoxConstraints(maxWidth: 1400),
          child: Container(
            width: effectiveWidth,
            margin: EdgeInsets.all(outerMargin),
            child: AppTheme.glass(
              borderRadius: 20,
              padding: EdgeInsets.all(innerPadding),
              color: Colors.white.withOpacity(0.08),
              child: _buildDesktopGrid(
                timetable,
                cellWidth,
                cellHeight,
                dayColumnWidth,
                true,
              ),
            ),
          ),
        ),
      ),
    );
  }

  Widget _buildDesktopGrid(
      List<TimetableEntry> timetable,
      double cellWidth,
      double cellHeight,
      double dayColumnWidth,
      bool isDesktop,
      ) {
    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      mainAxisSize: MainAxisSize.min,
      children: [
        // Header row
        Row(
          mainAxisSize: MainAxisSize.min,
          children: [
            SizedBox(width: dayColumnWidth, height: 60),
            ...List.generate(_timeSlots.length, (index) {
              final timeSlot = _timeSlots[index];
              return Container(
                width: cellWidth,
                height: 60,
                margin: const EdgeInsets.all(2),
                decoration: BoxDecoration(
                  color: Colors.white.withOpacity(0.1),
                  borderRadius: BorderRadius.circular(8),
                ),
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    Text(
                      timeSlot['period']!,
                      style: const TextStyle(
                        color: Colors.white,
                        fontWeight: FontWeight.bold,
                        fontSize: 16,
                      ),
                    ),
                    const SizedBox(height: 2),
                    Text(
                      timeSlot['start']!,
                      style: TextStyle(
                        color: Colors.grey[400],
                        fontSize: 10,
                      ),
                    ),
                    Text(
                      timeSlot['end']!,
                      style: TextStyle(
                        color: Colors.grey[400],
                        fontSize: 10,
                      ),
                    ),
                  ],
                ),
              );
            }),
          ],
        ),
        // Day rows
        ...List.generate(5, (dayIndex) {
          final dayOfWeek = dayIndex + 1;
          final isToday = DateTime.now().weekday == dayOfWeek;

          return Row(
            mainAxisSize: MainAxisSize.min,
            children: [
              Container(
                width: dayColumnWidth,
                height: cellHeight,
                margin: const EdgeInsets.all(2),
                decoration: BoxDecoration(
                  gradient: isToday
                      ? const LinearGradient(
                    colors: [Color(0xFFFF9800), Color(0xFFFF5722)],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  )
                      : null,
                  color: isToday ? null : Colors.white.withOpacity(0.1),
                  borderRadius: BorderRadius.circular(8),
                ),
                child: Center(
                  child: Column(
                    mainAxisAlignment: MainAxisAlignment.center,
                    children: [
                      Text(
                        _dayNames[dayIndex],
                        style: const TextStyle(
                          color: Colors.white,
                          fontWeight: FontWeight.bold,
                          fontSize: 16,
                        ),
                      ),
                      if (isToday)
                        Container(
                          margin: const EdgeInsets.only(top: 2),
                          width: 4,
                          height: 4,
                          decoration: const BoxDecoration(
                            color: Colors.white,
                            shape: BoxShape.circle,
                          ),
                        ),
                    ],
                  ),
                ),
              ),
              ...List.generate(_timeSlots.length, (periodIndex) {
                final period = periodIndex + 1;
                final entry = timetable.firstWhere(
                      (e) => e.dayOfWeek == dayOfWeek && e.period == period,
                  orElse: () => TimetableEntry(
                    id: 'empty',
                    subjectId: '',
                    teacherId: '',
                    classId: '',
                    room: '',
                    dayOfWeek: dayOfWeek,
                    period: period,
                    startTime: DateTime.now(),
                    endTime: DateTime.now(),
                  ),
                );

                return _buildTimetableCell(entry, cellWidth, cellHeight, true);
              }),
            ],
          );
        }),
      ],
    );
  }

  // Mobile view - horizontal scroll
  Widget _buildMobileView(List<TimetableEntry> timetable) {
    return Column(
      children: [
        // Current day indicator
        _buildDaySelector(),
        // Horizontal scrollable timetable
        Expanded(
          child: PageView.builder(
            itemCount: 5,
            controller: PageController(
              initialPage: DateTime.now().weekday - 1,
              viewportFraction: 1.0,
            ),
            itemBuilder: (context, dayIndex) {
              return _buildMobileDayView(timetable, dayIndex);
            },
          ),
        ),
      ],
    );
  }

  Widget _buildDaySelector() {
    final currentDay = DateTime.now().weekday - 1;

    return Container(
      margin: const EdgeInsets.all(16),
      child: AppTheme.glass(
        borderRadius: 16,
        padding: const EdgeInsets.symmetric(vertical: 8),
        color: Colors.white.withOpacity(0.08),
        child: Row(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: List.generate(5, (index) {
            final isToday = index == currentDay;
            return Container(
              padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),
              decoration: BoxDecoration(
                color: isToday
                    ? const Color(0xFFFF9800)
                    : Colors.transparent,
                borderRadius: BorderRadius.circular(12),
              ),
              child: Text(
                _dayNames[index],
                style: TextStyle(
                  color: Colors.white,
                  fontWeight: isToday ? FontWeight.bold : FontWeight.normal,
                  fontSize: 14,
                ),
              ),
            );
          }),
        ),
      ),
    );
  }

  Widget _buildMobileDayView(List<TimetableEntry> timetable, int dayIndex) {
    final dayOfWeek = dayIndex + 1;
    final dayLessons = timetable
        .where((e) => e.dayOfWeek == dayOfWeek)
        .toList()
      ..sort((a, b) => a.period.compareTo(b.period));

    return SingleChildScrollView(
      child: Padding(
        padding: const EdgeInsets.symmetric(horizontal: 16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: [
            // Day title
            Padding(
              padding: const EdgeInsets.only(bottom: 16),
              child: Text(
                _fullDayNames[dayIndex],
                style: const TextStyle(
                  color: Colors.white,
                  fontSize: 24,
                  fontWeight: FontWeight.bold,
                ),
                textAlign: TextAlign.center,
              ),
            ),
            // Lessons for this day
            ...List.generate(8, (periodIndex) {
              final period = periodIndex + 1;
              final entry = dayLessons.firstWhere(
                    (e) => e.period == period,
                orElse: () => TimetableEntry(
                  id: 'empty',
                  subjectId: '',
                  teacherId: '',
                  classId: '',
                  room: '',
                  dayOfWeek: dayOfWeek,
                  period: period,
                  startTime: DateTime.now(),
                  endTime: DateTime.now(),
                ),
              );

              return _buildMobileLessonCard(entry, period);
            }),
            const SizedBox(height: 20),
          ],
        ),
      ),
    );
  }

  Widget _buildMobileLessonCard(TimetableEntry entry, int period) {
    final timeSlot = _timeSlots[period - 1];

    if (entry.id == 'empty') {
      return Container(
        margin: const EdgeInsets.only(bottom: 12),
        child: AppTheme.glass(
          borderRadius: 16,
          padding: const EdgeInsets.all(16),
          color: Colors.white.withOpacity(0.03),
          border: BorderSide(
            color: Colors.white.withOpacity(0.1),
            width: 1,
          ),
          child: Row(
            children: [
              Container(
                width: 50,
                height: 50,
                decoration: BoxDecoration(
                  color: Colors.grey.withOpacity(0.3),
                  borderRadius: BorderRadius.circular(12),
                ),
                child: Center(
                  child: Text(
                    period.toString(),
                    style: const TextStyle(
                      color: Colors.white54,
                      fontWeight: FontWeight.bold,
                      fontSize: 18,
                    ),
                  ),
                ),
              ),
              const SizedBox(width: 16),
              Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    const Text(
                      'Volná hodina',
                      style: TextStyle(
                        color: Colors.white54,
                        fontSize: 16,
                        fontWeight: FontWeight.w500,
                      ),
                    ),
                    const SizedBox(height: 4),
                    Text(
                      '${timeSlot['start']} - ${timeSlot['end']}',
                      style: TextStyle(
                        color: Colors.grey[400],
                        fontSize: 12,
                      ),
                    ),
                  ],
                ),
              ),
            ],
          ),
        ),
      );
    }

    final subject = _dataService.getSubjectById(entry.subjectId);
    final teacher = _dataService.getTeacherById(entry.teacherId);

    if (subject == null) {
      return const SizedBox.shrink();
    }

    return Container(
      margin: const EdgeInsets.only(bottom: 12),
      child: AppTheme.glass(
        borderRadius: 16,
        padding: const EdgeInsets.all(16),
        color: subject.color.withOpacity(0.15),
        border: BorderSide(
          color: subject.color.withOpacity(0.5),
          width: 2,
        ),
        onTap: () => _showLessonDetail(entry, subject, teacher),
        child: Row(
          children: [
            Container(
              width: 50,
              height: 50,
              decoration: BoxDecoration(
                gradient: LinearGradient(
                  colors: [subject.color, subject.color.withOpacity(0.7)],
                  begin: Alignment.topLeft,
                  end: Alignment.bottomRight,
                ),
                borderRadius: BorderRadius.circular(12),
              ),
              child: Center(
                child: Text(
                  subject.shortName,
                  style: const TextStyle(
                    color: Colors.white,
                    fontWeight: FontWeight.bold,
                    fontSize: 14,
                  ),
                ),
              ),
            ),
            const SizedBox(width: 16),
            Expanded(
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(
                    subject.name,
                    style: const TextStyle(
                      color: Colors.white,
                      fontSize: 16,
                      fontWeight: FontWeight.bold,
                    ),
                  ),
                  const SizedBox(height: 4),
                  Text(
                    teacher?.lastName ?? 'Neznámý',
                    style: TextStyle(
                      color: Colors.grey[300],
                      fontSize: 14,
                    ),
                  ),
                  const SizedBox(height: 4),
                  Row(
                    children: [
                      Icon(
                        Icons.access_time,
                        size: 14,
                        color: Colors.grey[400],
                      ),
                      const SizedBox(width: 4),
                      Text(
                        '${timeSlot['start']} - ${timeSlot['end']}',
                        style: TextStyle(
                          color: Colors.grey[400],
                          fontSize: 12,
                        ),
                      ),
                      const SizedBox(width: 12),
                      Icon(
                        Icons.room_outlined,
                        size: 14,
                        color: Colors.grey[400],
                      ),
                      const SizedBox(width: 4),
                      Text(
                        entry.room,
                        style: TextStyle(
                          color: Colors.grey[400],
                          fontSize: 12,
                        ),
                      ),
                    ],
                  ),
                ],
              ),
            ),
            Icon(
              Icons.chevron_right,
              color: Colors.white.withOpacity(0.5),
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildTimetableCell(
      TimetableEntry entry,
      double width,
      double height,
      bool isDesktop,
      ) {
    if (entry.id == 'empty') {
      return Container(
        width: width,
        height: height,
        margin: const EdgeInsets.all(2),
        decoration: BoxDecoration(
          color: Colors.white.withOpacity(0.03),
          borderRadius: BorderRadius.circular(8),
          border: Border.all(
            color: Colors.white.withOpacity(0.1),
            width: 1,
          ),
        ),
      );
    }

    final subject = _dataService.getSubjectById(entry.subjectId);
    final teacher = _dataService.getTeacherById(entry.teacherId);

    if (subject == null) {
      return Container(
        width: width,
        height: height,
        margin: const EdgeInsets.all(2),
      );
    }

    final isSelected = _selectedEntry?.id == entry.id;

    return GestureDetector(
      onTap: () => _showLessonDetail(entry, subject, teacher),
      child: MouseRegion(
        cursor: SystemMouseCursors.click,
        onEnter: (_) => setState(() => _selectedEntry = entry),
        onExit: (_) => setState(() => _selectedEntry = null),
        child: AnimatedContainer(
          duration: const Duration(milliseconds: 200),
          width: width,
          height: height,
          margin: const EdgeInsets.all(2),
          decoration: BoxDecoration(
            gradient: LinearGradient(
              colors: [
                subject.color,
                subject.color.withOpacity(0.7),
              ],
              begin: Alignment.topLeft,
              end: Alignment.bottomRight,
            ),
            borderRadius: BorderRadius.circular(8),
            border: Border.all(
              color: isSelected ? Colors.white : subject.color.withOpacity(0.5),
              width: isSelected ? 2 : 1,
            ),
            boxShadow: isSelected
                ? [
              BoxShadow(
                color: subject.color.withOpacity(0.5),
                blurRadius: 12,
                offset: const Offset(0, 4),
              ),
            ]
                : null,
          ),
          child: Padding(
            padding: const EdgeInsets.all(8),
            child: Column(
              mainAxisAlignment: MainAxisAlignment.center,
              crossAxisAlignment: CrossAxisAlignment.center,
              children: [
                Text(
                  subject.shortName,
                  style: const TextStyle(
                    color: Colors.white,
                    fontWeight: FontWeight.bold,
                    fontSize: 15,
                  ),
                  textAlign: TextAlign.center,
                  maxLines: 1,
                  overflow: TextOverflow.ellipsis,
                ),
                const SizedBox(height: 2),
                Text(
                  teacher?.lastName ?? '',
                  style: TextStyle(
                    color: Colors.white.withOpacity(0.9),
                    fontSize: 11,
                  ),
                  textAlign: TextAlign.center,
                  maxLines: 1,
                  overflow: TextOverflow.ellipsis,
                ),
                const SizedBox(height: 2),
                Text(
                  entry.room,
                  style: TextStyle(
                    color: Colors.white.withOpacity(0.8),
                    fontSize: 10,
                  ),
                  textAlign: TextAlign.center,
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }

  void _showLessonDetail(
      TimetableEntry entry,
      Subject subject,
      Teacher? teacher,
      ) {
    final startTime =
        '${entry.startTime.hour.toString().padLeft(2, '0')}:${entry.startTime.minute.toString().padLeft(2, '0')}';
    final endTime =
        '${entry.endTime.hour.toString().padLeft(2, '0')}:${entry.endTime.minute.toString().padLeft(2, '0')}';

    showDialog(
      context: context,
      builder: (BuildContext context) {
        return AlertDialog(
          title: Row(
            children: [
              Container(
                width: 40,
                height: 40,
                decoration: BoxDecoration(
                  gradient: LinearGradient(
                    colors: [subject.color, subject.color.withOpacity(0.7)],
                    begin: Alignment.topLeft,
                    end: Alignment.bottomRight,
                  ),
                  borderRadius: BorderRadius.circular(8),
                ),
                child: Center(
                  child: Text(
                    subject.shortName,
                    style: const TextStyle(
                      color: Colors.white,
                      fontWeight: FontWeight.bold,
                      fontSize: 14,
                    ),
                  ),
                ),
              ),
              const SizedBox(width: 12),
              Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      subject.name,
                      style: const TextStyle(fontSize: 18),
                    ),
                    Text(
                      '${_fullDayNames[entry.dayOfWeek - 1]} | ${entry.period}. hodina',
                      style: TextStyle(
                        fontSize: 12,
                        color: Colors.grey[600],
                        fontWeight: FontWeight.normal,
                      ),
                    ),
                  ],
                ),
              ),
            ],
          ),
          content: Column(
            mainAxisSize: MainAxisSize.min,
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              _buildDetailRow(Icons.access_time, 'Čas', '$startTime - $endTime'),
              const SizedBox(height: 12),
              _buildDetailRow(
                Icons.person_outline,
                'Učitel',
                teacher?.fullName ?? 'Neznámý',
              ),
              const SizedBox(height: 12),
              _buildDetailRow(Icons.room_outlined, 'Místnost', entry.room),
              const SizedBox(height: 12),
              _buildDetailRow(
                Icons.event_outlined,
                'Den',
                _fullDayNames[entry.dayOfWeek - 1],
              ),
            ],
          ),
          actions: [
            TextButton(
              onPressed: () => Navigator.of(context).pop(),
              child: const Text('Zavřít'),
            ),
          ],
        );
      },
    );
  }

  Widget _buildDetailRow(IconData icon, String label, String value) {
    return Row(
      children: [
        Icon(icon, size: 20, color: Colors.grey[600]),
        const SizedBox(width: 8),
        Text(
          '$label: ',
          style: const TextStyle(fontWeight: FontWeight.bold),
        ),
        Expanded(
          child: Text(value),
        ),
      ],
    );
  }

  void _showInfoDialog(BuildContext context) {
    showDialog(
      context: context,
      builder: (BuildContext context) {
        return const AlertDialog(
          title: Text('O rozvrhu'),
          content: Column(
            mainAxisSize: MainAxisSize.min,
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Text('Zobrazení týdenního rozvrhu hodin.'),
              SizedBox(height: 12),
              Text('• Na mobilu: přejeďte prstem doleva/doprava pro další dny'),
              Text('• Kliknutím na hodinu zobrazíte detaily'),
              Text('• Aktuální den je zvýrazněn oranžově'),
              Text('• Barvy odpovídají jednotlivým předmětům'),
            ],
          ),
        );
      },
    );
  }
}


================================================================================

File: services/data_service.dart
------------------------------------------------------------
import 'package:flutter/material.dart';
import '../models/data_models.dart';
import '../models/user_model.dart';

class DataService {
  static final DataService _instance = DataService._internal();

  factory DataService() => _instance;

    DataService._internal() {
    _initializeData();
  }

    String? _currentUserId;
  UserType? _currentUserType;

  void setCurrentUser(String userId, UserType userType) {
    _currentUserId = userId;
    _currentUserType = userType;
  }

  String? get currentUserId => _currentUserId;
  UserType? get currentUserType => _currentUserType;

    late final List<Student> _students;
  late final List<Teacher> _teachers;
  late final List<SchoolClass> _classes;
  late final List<Subject> _subjects;
  late final List<TimetableEntry> _timetable;
  late final List<Grade> _grades;
  late final List<Attendance> _attendance;
  late final List<Assignment> _assignments;
  late final List<Message> _messages;
  late final List<SchoolEvent> _events;
  late final List<Document> _documents;

  void _initializeData() {
    _initializeSubjects();
    _initializeTeachers();
    _initializeClasses();
    _initializeStudents();
    _initializeTimetable();
    _initializeGrades();
    _initializeAttendance();
    _initializeAssignments();
    _initializeMessages();
    _initializeEvents();
    _initializeDocuments();
  }

  void _initializeSubjects() {
    _subjects = [
      Subject(id: '1', name: 'Matematika', shortName: 'MAT', color: Colors.blue),
      Subject(id: '2', name: 'Český jazyk', shortName: 'ČJ', color: Colors.red),
      Subject(id: '3', name: 'Anglický jazyk', shortName: 'AJ', color: Colors.green),
      Subject(id: '4', name: 'Fyzika', shortName: 'FYZ', color: Colors.purple),
      Subject(id: '5', name: 'Chemie', shortName: 'CHE', color: Colors.orange),
      Subject(id: '6', name: 'Biologie', shortName: 'BIO', color: Colors.teal),
      Subject(id: '7', name: 'Dějepis', shortName: 'DEJ', color: Colors.brown),
      Subject(id: '8', name: 'Zeměpis', shortName: 'ZEM', color: Colors.cyan),
      Subject(id: '9', name: 'Informatika', shortName: 'INF', color: Colors.indigo),
      Subject(id: '10', name: 'Tělesná výchova', shortName: 'TV', color: Colors.amber),
    ];
  }

  void _initializeTeachers() {
    _teachers = [
      Teacher(
        id: 'teacher1',
        firstName: 'Jan',
        lastName: 'Novák',
        email: 'j.novak@skola.cz',
        phone: '+420 123 456 789',
        subjectIds: ['1', '4'],
        classIds: ['1a', '2a', '3b', '3c'],
        title: 'Mgr.',
      ),
      Teacher(
        id: 'teacher2',
        firstName: 'Marie',
        lastName: 'Svobodová',
        email: 'm.svobodova@skola.cz',
        phone: '+420 234 567 890',
        subjectIds: ['2', '7'],
        classIds: ['2a', '2b'],
        title: 'PhDr.',
      ),
      Teacher(
        id: 'teacher3',
        firstName: 'Petr',
        lastName: 'Dvořák',
        email: 'p.dvorak@skola.cz',
        phone: '+420 345 678 901',
        subjectIds: ['3'],
        classIds: ['2a', '2b', '3a', '3b'],
        title: 'Mgr.',
      ),
      Teacher(
        id: 'teacher4',
        firstName: 'Eva',
        lastName: 'Procházková',
        email: 'e.prochazkova@skola.cz',
        phone: '+420 456 789 012',
        subjectIds: ['5', '6'],
        classIds: ['2a', '3a', '3b'],
        title: 'RNDr.',
      ),
      Teacher(
        id: 'teacher5',
        firstName: 'Pavel',
        lastName: 'Sportovec',
        email: 'p.sportovec@skola.cz',
        phone: '+420 567 890 123',
        subjectIds: ['10'],         classIds: ['2a', '2b', '3a'],
        title: 'Mgr.',
      ),
      Teacher(
        id: 'teacher6',
        firstName: 'Lucie',
        lastName: 'Kodérová',
        email: 'l.koderova@skola.cz',
        phone: '+420 678 901 234',
        subjectIds: ['9'],         classIds: ['2a', '3b'],
        title: 'Ing.',
      ),
      Teacher(
        id: 'teacher7',
        firstName: 'Martin',
        lastName: 'Zeměpisný',
        email: 'm.zemepisny@skola.cz',
        phone: '+420 789 012 345',
        subjectIds: ['8'],         classIds: ['2a', '3a', '3b'],
        title: 'Mgr.',
      ),
    ];
  }

  void _initializeClasses() {
    _classes = [
      SchoolClass(
        id: '1a',
        name: '1.A',
        teacherId: 'teacher1',
        studentIds: ['student13', 'student14', 'student15', 'student18'],
        year: 7,
      ),
      SchoolClass(
        id: '2a',
        name: '2.A',
        teacherId: 'teacher1',
        studentIds: ['student1', 'student2', 'student3', 'student9', 'student10'],
        year: 8,
      ),
      SchoolClass(
        id: '2b',
        name: '2.B',
        teacherId: 'teacher2',
        studentIds: ['student4', 'student5', 'student6'],
        year: 8,
      ),
      SchoolClass(
        id: '3a',
        name: '3.A',
        teacherId: 'teacher3',
        studentIds: [],
        year: 9,
      ),
      SchoolClass(
        id: '3b',
        name: '3.B',
        teacherId: 'teacher4',
        studentIds: ['student7', 'student8', 'student11', 'student12'],
        year: 9,
      ),
      SchoolClass(
        id: '3c',
        name: '3.C',
        teacherId: 'teacher1',
        studentIds: ['student16', 'student17', 'student19'],
        year: 9,
      ),
    ];
  }

  void _initializeStudents() {
    _students = [
            Student(
        id: 'student13',
        firstName: 'Lucie',
        lastName: 'Nováková',
        classId: '1a',
        email: 'l.novakova@student.skola.cz',
        birthDate: DateTime(2011, 4, 10),
        parentEmail: 'novakova.rodic@email.cz',
        parentPhone: '+420 777 888 999',
        address: 'Parková 15, Praha',
      ),
      Student(
        id: 'student14',
        firstName: 'Jan',
        lastName: 'Dvořák',
        classId: '1a',
        email: 'j.dvorak@student.skola.cz',
        birthDate: DateTime(2011, 7, 22),
        parentEmail: 'dvorak.rodic@email.cz',
        parentPhone: '+420 666 555 444',
        address: 'Lesní 20, Praha',
      ),
      Student(
        id: 'student15',
        firstName: 'Eva',
        lastName: 'Malá',
        classId: '1a',
        email: 'e.mala@student.skola.cz',
        birthDate: DateTime(2011, 12, 5),
        parentEmail: 'mala.rodic@email.cz',
        parentPhone: '+420 333 222 111',
        address: 'Školní 33, Praha',
      ),
      Student(
        id: 'student18',
        firstName: 'Tomáš',
        lastName: 'Veselý',
        classId: '1a',
        email: 't.vesely@student.skola.cz',
        birthDate: DateTime(2011, 9, 18),
        parentEmail: 'vesely.rodic@email.cz',
        parentPhone: '+420 444 333 222',
        address: 'Krátká 8, Praha',
      ),

            Student(
        id: 'student1',
        firstName: 'Tomáš',
        lastName: 'Kolář',
        classId: '2a',
        email: 't.kolar@student.skola.cz',
        birthDate: DateTime(2010, 5, 15),
        parentEmail: 'kolar.rodic@email.cz',
        parentPhone: '+420 601 234 567',
        address: 'Hlavní 123, Praha',
      ),
      Student(
        id: 'student2',
        firstName: 'Anna',
        lastName: 'Horáková',
        classId: '2a',
        email: 'a.horakova@student.skola.cz',
        birthDate: DateTime(2010, 3, 22),
        parentEmail: 'horakova.rodic@email.cz',
        parentPhone: '+420 602 345 678',
        address: 'Školní 456, Praha',
      ),
      Student(
        id: 'student3',
        firstName: 'David',
        lastName: 'Černý',
        classId: '2a',
        email: 'd.cerny@student.skola.cz',
        birthDate: DateTime(2010, 8, 10),
        parentEmail: 'cerny.rodic@email.cz',
        parentPhone: '+420 603 456 789',
        address: 'Nová 789, Praha',
      ),
      Student(
        id: 'student9',
        firstName: 'Eliška',
        lastName: 'Nováková',
        classId: '2a',
        email: 'e.novakova@student.skola.cz',
        birthDate: DateTime(2010, 1, 30),
        parentEmail: 'novakova.rodic@email.cz',
        parentPhone: '+420 609 123 456',
        address: 'Parkova 15, Praha',
      ),
      Student(
        id: 'student10',
        firstName: 'Filip',
        lastName: 'Procházka',
        classId: '2a',
        email: 'f.prochazka@student.skola.cz',
        birthDate: DateTime(2010, 6, 18),
        parentEmail: 'prochazka.rodic@email.cz',
        parentPhone: '+420 610 234 567',
        address: 'Lesní 42, Praha',
      ),

            Student(
        id: 'student4',
        firstName: 'Klára',
        lastName: 'Veselá',
        classId: '2b',
        email: 'k.vesela@student.skola.cz',
        birthDate: DateTime(2010, 12, 3),
        parentEmail: 'vesela.rodic@email.cz',
        parentPhone: '+420 604 567 890',
        address: 'Krásná 321, Praha',
      ),
      Student(
        id: 'student5',
        firstName: 'Martin',
        lastName: 'Svoboda',
        classId: '2b',
        email: 'm.svoboda@student.skola.cz',
        birthDate: DateTime(2010, 7, 18),
        parentEmail: 'svoboda.rodic@email.cz',
        parentPhone: '+420 605 678 901',
        address: 'Dlouhá 654, Praha',
      ),
      Student(
        id: 'student6',
        firstName: 'Jakub',
        lastName: 'Novotný',
        classId: '2b',
        email: 'j.novotny@student.skola.cz',
        birthDate: DateTime(2010, 9, 14),
        parentEmail: 'novotny.rodic@email.cz',
        parentPhone: '+420 606 789 012',
        address: 'Školní 987, Praha',
      ),

            Student(
        id: 'student7',
        firstName: 'Tereza',
        lastName: 'Svobodová',
        classId: '3b',
        email: 't.svobodova@student.skola.cz',
        birthDate: DateTime(2009, 4, 25),
        parentEmail: 'svobodova.rodic@email.cz',
        parentPhone: '+420 607 890 123',
        address: 'Nádražní 654, Praha',
      ),
      Student(
        id: 'student8',
        firstName: 'Michal',
        lastName: 'Dvořák',
        classId: '3b',
        email: 'm.dvorak@student.skola.cz',
        birthDate: DateTime(2009, 11, 8),
        parentEmail: 'dvorak.rodic@email.cz',
        parentPhone: '+420 608 901 234',
        address: 'Krásná 321, Praha',
      ),
      Student(
        id: 'student11',
        firstName: 'Viktorie',
        lastName: 'Kratochvílová',
        classId: '3b',
        email: 'v.kratochvilova@student.skola.cz',
        birthDate: DateTime(2009, 2, 12),
        parentEmail: 'kratochvilova.rodic@email.cz',
        parentPhone: '+420 611 345 678',
        address: 'Zahradní 28, Praha',
      ),
      Student(
        id: 'student12',
        firstName: 'Ondřej',
        lastName: 'Krejčí',
        classId: '3b',
        email: 'o.krejci@student.skola.cz',
        birthDate: DateTime(2009, 9, 5),
        parentEmail: 'krejci.rodic@email.cz',
        parentPhone: '+420 612 456 789',
        address: 'Sportovní 73, Praha',
      ),

            Student(
        id: 'student16',
        firstName: 'Petr',
        lastName: 'Horák',
        classId: '3c',
        email: 'p.horak@student.skola.cz',
        birthDate: DateTime(2009, 3, 15),
        parentEmail: 'horak.rodic@email.cz',
        parentPhone: '+420 999 888 777',
        address: 'Nádražní 44, Praha',
      ),
      Student(
        id: 'student17',
        firstName: 'Michaela',
        lastName: 'Krejčí',
        classId: '3c',
        email: 'm.krejci@student.skola.cz',
        birthDate: DateTime(2009, 6, 21),
        parentEmail: 'krejci.rodic@email.cz',
        parentPhone: '+420 111 222 333',
        address: 'Zahradní 55, Praha',
      ),
      Student(
        id: 'student19',
        firstName: 'Štěpán',
        lastName: 'Pokorný',
        classId: '3c',
        email: 's.pokorny@student.skola.cz',
        birthDate: DateTime(2009, 10, 12),
        parentEmail: 'pokorny.rodic@email.cz',
        parentPhone: '+420 555 666 777',
        address: 'Dlouhá 88, Praha',
      ),
    ];
  }

  void _initializeTimetable() {
        _timetable = [
            TimetableEntry(
        id: 'tt1',
        subjectId: '1',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U102',
        dayOfWeek: 1,
        period: 1,
        startTime: DateTime(2024, 1, 1, 7, 5),
        endTime: DateTime(2024, 1, 1, 7, 50),
      ),
      TimetableEntry(
        id: 'tt2',
        subjectId: '2',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U205',
        dayOfWeek: 1,
        period: 2,
        startTime: DateTime(2024, 1, 1, 8, 0),
        endTime: DateTime(2024, 1, 1, 8, 45),
      ),
      TimetableEntry(
        id: 'tt3',
        subjectId: '3',
        teacherId: 'teacher3',
        classId: '2a',
        room: 'U308',
        dayOfWeek: 1,
        period: 3,
        startTime: DateTime(2024, 1, 1, 8, 55),
        endTime: DateTime(2024, 1, 1, 9, 40),
      ),
      TimetableEntry(
        id: 'tt4',
        subjectId: '4',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U110',
        dayOfWeek: 1,
        period: 4,
        startTime: DateTime(2024, 1, 1, 9, 55),
        endTime: DateTime(2024, 1, 1, 10, 40),
      ),
      TimetableEntry(
        id: 'tt5',
        subjectId: '10',
        teacherId: 'teacher5',
        classId: '2a',
        room: 'Tělocvična',
        dayOfWeek: 1,
        period: 5,
        startTime: DateTime(2024, 1, 1, 10, 50),
        endTime: DateTime(2024, 1, 1, 11, 35),
      ),
      TimetableEntry(
        id: 'tt6',
        subjectId: '7',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U303',
        dayOfWeek: 1,
        period: 6,
        startTime: DateTime(2024, 1, 1, 11, 45),
        endTime: DateTime(2024, 1, 1, 12, 30),
      ),
      TimetableEntry(
        id: 'tt34',
        subjectId: '9',
        teacherId: 'teacher6',
        classId: '2a',
        room: 'U401',
        dayOfWeek: 1,
        period: 7,
        startTime: DateTime(2024, 1, 1, 12, 40),
        endTime: DateTime(2024, 1, 1, 13, 25),
      ),
      TimetableEntry(
        id: 'tt35',
        subjectId: '6',
        teacherId: 'teacher4',
        classId: '2a',
        room: 'U202',
        dayOfWeek: 1,
        period: 8,
        startTime: DateTime(2024, 1, 1, 13, 35),
        endTime: DateTime(2024, 1, 1, 14, 20),
      ),

            TimetableEntry(
        id: 'tt7',
        subjectId: '5',
        teacherId: 'teacher4',
        classId: '2a',
        room: 'U201',
        dayOfWeek: 2,
        period: 1,
        startTime: DateTime(2024, 1, 1, 7, 5),
        endTime: DateTime(2024, 1, 1, 7, 50),
      ),
      TimetableEntry(
        id: 'tt8',
        subjectId: '1',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U102',
        dayOfWeek: 2,
        period: 2,
        startTime: DateTime(2024, 1, 1, 8, 0),
        endTime: DateTime(2024, 1, 1, 8, 45),
      ),
      TimetableEntry(
        id: 'tt9',
        subjectId: '7',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U303',
        dayOfWeek: 2,
        period: 3,
        startTime: DateTime(2024, 1, 1, 8, 55),
        endTime: DateTime(2024, 1, 1, 9, 40),
      ),
      TimetableEntry(
        id: 'tt10',
        subjectId: '2',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U205',
        dayOfWeek: 2,
        period: 4,
        startTime: DateTime(2024, 1, 1, 9, 55),
        endTime: DateTime(2024, 1, 1, 10, 40),
      ),
      TimetableEntry(
        id: 'tt11',
        subjectId: '9',
        teacherId: 'teacher6',
        classId: '2a',
        room: 'U401',
        dayOfWeek: 2,
        period: 5,
        startTime: DateTime(2024, 1, 1, 10, 50),
        endTime: DateTime(2024, 1, 1, 11, 35),
      ),
      TimetableEntry(
        id: 'tt12',
        subjectId: '3',
        teacherId: 'teacher3',
        classId: '2a',
        room: 'U308',
        dayOfWeek: 2,
        period: 6,
        startTime: DateTime(2024, 1, 1, 11, 45),
        endTime: DateTime(2024, 1, 1, 12, 30),
      ),
      TimetableEntry(
        id: 'tt13',
        subjectId: '8',
        teacherId: 'teacher7',
        classId: '2a',
        room: 'U304',
        dayOfWeek: 2,
        period: 7,
        startTime: DateTime(2024, 1, 1, 12, 40),
        endTime: DateTime(2024, 1, 1, 13, 25),
      ),
      TimetableEntry(
        id: 'tt36',
        subjectId: '4',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U110',
        dayOfWeek: 2,
        period: 8,
        startTime: DateTime(2024, 1, 1, 13, 35),
        endTime: DateTime(2024, 1, 1, 14, 20),
      ),

            TimetableEntry(
        id: 'tt14',
        subjectId: '3',
        teacherId: 'teacher3',
        classId: '2a',
        room: 'U308',
        dayOfWeek: 3,
        period: 1,
        startTime: DateTime(2024, 1, 1, 7, 5),
        endTime: DateTime(2024, 1, 1, 7, 50),
      ),
      TimetableEntry(
        id: 'tt15',
        subjectId: '6',
        teacherId: 'teacher4',
        classId: '2a',
        room: 'U202',
        dayOfWeek: 3,
        period: 2,
        startTime: DateTime(2024, 1, 1, 8, 0),
        endTime: DateTime(2024, 1, 1, 8, 45),
      ),
      TimetableEntry(
        id: 'tt16',
        subjectId: '1',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U102',
        dayOfWeek: 3,
        period: 3,
        startTime: DateTime(2024, 1, 1, 8, 55),
        endTime: DateTime(2024, 1, 1, 9, 40),
      ),
      TimetableEntry(
        id: 'tt17',
        subjectId: '8',
        teacherId: 'teacher7',
        classId: '2a',
        room: 'U304',
        dayOfWeek: 3,
        period: 4,
        startTime: DateTime(2024, 1, 1, 9, 55),
        endTime: DateTime(2024, 1, 1, 10, 40),
      ),
      TimetableEntry(
        id: 'tt18',
        subjectId: '2',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U205',
        dayOfWeek: 3,
        period: 5,
        startTime: DateTime(2024, 1, 1, 10, 50),
        endTime: DateTime(2024, 1, 1, 11, 35),
      ),
      TimetableEntry(
        id: 'tt19',
        subjectId: '4',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U110',
        dayOfWeek: 3,
        period: 6,
        startTime: DateTime(2024, 1, 1, 11, 45),
        endTime: DateTime(2024, 1, 1, 12, 30),
      ),
      TimetableEntry(
        id: 'tt37',
        subjectId: '5',
        teacherId: 'teacher4',
        classId: '2a',
        room: 'U201',
        dayOfWeek: 3,
        period: 7,
        startTime: DateTime(2024, 1, 1, 12, 40),
        endTime: DateTime(2024, 1, 1, 13, 25),
      ),
      TimetableEntry(
        id: 'tt38',
        subjectId: '7',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U303',
        dayOfWeek: 3,
        period: 8,
        startTime: DateTime(2024, 1, 1, 13, 35),
        endTime: DateTime(2024, 1, 1, 14, 20),
      ),

            TimetableEntry(
        id: 'tt20',
        subjectId: '2',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U205',
        dayOfWeek: 4,
        period: 1,
        startTime: DateTime(2024, 1, 1, 7, 5),
        endTime: DateTime(2024, 1, 1, 7, 50),
      ),
      TimetableEntry(
        id: 'tt21',
        subjectId: '4',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U110',
        dayOfWeek: 4,
        period: 2,
        startTime: DateTime(2024, 1, 1, 8, 0),
        endTime: DateTime(2024, 1, 1, 8, 45),
      ),
      TimetableEntry(
        id: 'tt22',
        subjectId: '3',
        teacherId: 'teacher3',
        classId: '2a',
        room: 'U308',
        dayOfWeek: 4,
        period: 3,
        startTime: DateTime(2024, 1, 1, 8, 55),
        endTime: DateTime(2024, 1, 1, 9, 40),
      ),
      TimetableEntry(
        id: 'tt23',
        subjectId: '1',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U102',
        dayOfWeek: 4,
        period: 4,
        startTime: DateTime(2024, 1, 1, 9, 55),
        endTime: DateTime(2024, 1, 1, 10, 40),
      ),
      TimetableEntry(
        id: 'tt24',
        subjectId: '10',
        teacherId: 'teacher5',
        classId: '2a',
        room: 'Tělocvična',
        dayOfWeek: 4,
        period: 5,
        startTime: DateTime(2024, 1, 1, 10, 50),
        endTime: DateTime(2024, 1, 1, 11, 35),
      ),
      TimetableEntry(
        id: 'tt25',
        subjectId: '5',
        teacherId: 'teacher4',
        classId: '2a',
        room: 'U201',
        dayOfWeek: 4,
        period: 6,
        startTime: DateTime(2024, 1, 1, 11, 45),
        endTime: DateTime(2024, 1, 1, 12, 30),
      ),
      TimetableEntry(
        id: 'tt26',
        subjectId: '9',
        teacherId: 'teacher6',
        classId: '2a',
        room: 'U401',
        dayOfWeek: 4,
        period: 7,
        startTime: DateTime(2024, 1, 1, 12, 40),
        endTime: DateTime(2024, 1, 1, 13, 25),
      ),
      TimetableEntry(
        id: 'tt39',
        subjectId: '1',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U102',
        dayOfWeek: 4,
        period: 8,
        startTime: DateTime(2024, 1, 1, 13, 35),
        endTime: DateTime(2024, 1, 1, 14, 20),
      ),

            TimetableEntry(
        id: 'tt27',
        subjectId: '9',
        teacherId: 'teacher6',
        classId: '2a',
        room: 'U401',
        dayOfWeek: 5,
        period: 1,
        startTime: DateTime(2024, 1, 1, 7, 5),
        endTime: DateTime(2024, 1, 1, 7, 50),
      ),
      TimetableEntry(
        id: 'tt28',
        subjectId: '7',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U303',
        dayOfWeek: 5,
        period: 2,
        startTime: DateTime(2024, 1, 1, 8, 0),
        endTime: DateTime(2024, 1, 1, 8, 45),
      ),
      TimetableEntry(
        id: 'tt29',
        subjectId: '5',
        teacherId: 'teacher4',
        classId: '2a',
        room: 'U201',
        dayOfWeek: 5,
        period: 3,
        startTime: DateTime(2024, 1, 1, 8, 55),
        endTime: DateTime(2024, 1, 1, 9, 40),
      ),
      TimetableEntry(
        id: 'tt30',
        subjectId: '2',
        teacherId: 'teacher2',
        classId: '2a',
        room: 'U205',
        dayOfWeek: 5,
        period: 4,
        startTime: DateTime(2024, 1, 1, 9, 55),
        endTime: DateTime(2024, 1, 1, 10, 40),
      ),
      TimetableEntry(
        id: 'tt31',
        subjectId: '1',
        teacherId: 'teacher1',
        classId: '2a',
        room: 'U102',
        dayOfWeek: 5,
        period: 5,
        startTime: DateTime(2024, 1, 1, 10, 50),
        endTime: DateTime(2024, 1, 1, 11, 35),
      ),
      TimetableEntry(
        id: 'tt32',
        subjectId: '6',
        teacherId: 'teacher4',
        classId: '2a',
        room: 'U202',
        dayOfWeek: 5,
        period: 6,
        startTime: DateTime(2024, 1, 1, 11, 45),
        endTime: DateTime(2024, 1, 1, 12, 30),
      ),
      TimetableEntry(
        id: 'tt33',
        subjectId: '3',
        teacherId: 'teacher3',
        classId: '2a',
        room: 'U308',
        dayOfWeek: 5,
        period: 7,
        startTime: DateTime(2024, 1, 1, 12, 40),
        endTime: DateTime(2024, 1, 1, 13, 25),
      ),
      TimetableEntry(
        id: 'tt40',
        subjectId: '8',
        teacherId: 'teacher7',
        classId: '2a',
        room: 'U304',
        dayOfWeek: 5,
        period: 8,
        startTime: DateTime(2024, 1, 1, 13, 35),
        endTime: DateTime(2024, 1, 1, 14, 20),
      ),
    ];
  }

  void _initializeGrades() {
    _grades = [
            Grade(
        id: 'g1',
        studentId: 'student1',
        subjectId: '1',
        teacherId: 'teacher1',
        value: 2,
        description: 'Písemná práce - kvadratické rovnice',
        date: DateTime.now().subtract(const Duration(days: 5)),
        type: GradeType.test,
        weight: 8.0,
      ),
      Grade(
        id: 'g2',
        studentId: 'student1',
        subjectId: '1',
        teacherId: 'teacher1',
        value: 1,
        description: 'Domácí úkol - funkce',
        date: DateTime.now().subtract(const Duration(days: 12)),
        type: GradeType.homework,
        weight: 3.0,
      ),
      Grade(
        id: 'g3',
        studentId: 'student1',
        subjectId: '1',
        teacherId: 'teacher1',
        value: 3,
        description: 'Ústní zkoušení - geometrie',
        date: DateTime.now().subtract(const Duration(days: 8)),
        type: GradeType.exam,
        weight: 5.0,
      ),

            Grade(
        id: 'g8',
        studentId: 'student1',
        subjectId: '4',
        teacherId: 'teacher1',
        value: 2,
        description: 'Laboratorní práce - mechanika',
        date: DateTime.now().subtract(const Duration(days: 7)),
        type: GradeType.classwork,
        weight: 6.0,
      ),

            Grade(
        id: 'g12',
        studentId: 'student1',
        subjectId: '2',
        teacherId: 'teacher2',
        value: 1,
        description: 'Slohová práce - popis osoby',
        date: DateTime.now().subtract(const Duration(days: 15)),
        type: GradeType.project,
        weight: 7.0,
      ),

            Grade(
        id: 'g16',
        studentId: 'student1',
        subjectId: '3',
        teacherId: 'teacher3',
        value: 1,
        description: 'Vocabulary test - Unit 5',
        date: DateTime.now().subtract(const Duration(days: 4)),
        type: GradeType.test,
        weight: 6.0,
      ),
    ];
  }

  void _initializeAttendance() {
    _attendance = [];
  }

  void _initializeAssignments() {
    _assignments = [];
  }

  void _initializeMessages() {
    _messages = [];
  }

  void _initializeEvents() {
    _events = [];
  }

  void _initializeDocuments() {
    _documents = [];
  }

    List<Subject> get subjects => _subjects;
  List<TimetableEntry> get timetable => _timetable;

    List<TimetableEntry> getTimetableForClass(String classId) {
    return _timetable.where((entry) => entry.classId == classId).toList()
      ..sort((a, b) {
        if (a.dayOfWeek != b.dayOfWeek) {
          return a.dayOfWeek.compareTo(b.dayOfWeek);
        }
        return a.period.compareTo(b.period);
      });
  }

    List<TimetableEntry> getTimetableForTeacher(String teacherId) {
    return _timetable.where((entry) => entry.teacherId == teacherId).toList()
      ..sort((a, b) {
        if (a.dayOfWeek != b.dayOfWeek) {
          return a.dayOfWeek.compareTo(b.dayOfWeek);
        }
        return a.period.compareTo(b.period);
      });
  }

    List<Student> get students => List.unmodifiable(_students);
  List<Teacher> get teachers => List.unmodifiable(_teachers);
  List<SchoolClass> get classes => List.unmodifiable(_classes);
  List<Grade> get grades => List.unmodifiable(_grades);

    Student? getCurrentStudent() {
    if (_currentUserType == UserType.student && _currentUserId != null) {
      return _students.firstWhere((s) => s.id == _currentUserId);
    }
    return null;
  }

  Teacher? getCurrentTeacher() {
    if (_currentUserType == UserType.teacher && _currentUserId != null) {
      return _teachers.firstWhere((t) => t.id == _currentUserId);
    }
    return null;
  }

  List<Grade> getGradesForStudent(String studentId) {
    return _grades.where((g) => g.studentId == studentId).toList();
  }

  Subject? getSubjectById(String id) {
    return _subjects.firstWhere((s) => s.id == id);
  }

  Teacher? getTeacherById(String id) {
    try {
      return _teachers.firstWhere((t) => t.id == id);
    } catch (e) {
      return null;
    }
  }

  SchoolClass? getClassById(String id) {
    try {
      return _classes.firstWhere((c) => c.id == id);
    } catch (e) {
      return null;
    }
  }

  List<SchoolClass> getClassesForTeacher(String teacherId) {
    return _classes.where((c) => c.teacherId == teacherId).toList();
  }

  List<Student> getStudentsForClass(String classId) {
    return _students.where((s) => s.classId == classId).toList();
  }

  List<Subject> getSubjectsForTeacher(String teacherId) {
    final teacher = getTeacherById(teacherId);
    if (teacher == null) return [];
    return _subjects.where((s) => teacher.subjectIds.contains(s.id)).toList();
  }

  List<Grade> getGradesForClassAndSubject(String classId, String subjectId) {
    final classStudents = getStudentsForClass(classId);
    final studentIds = classStudents.map((s) => s.id).toList();
    return _grades
        .where(
            (g) => studentIds.contains(g.studentId) && g.subjectId == subjectId)
        .toList();
  }
}


================================================================================

File: theme/app_theme.dart
------------------------------------------------------------
import 'dart:ui';
import 'package:flutter/material.dart';
import 'package:flutter/services.dart';

class AppTheme {
  static const Color primaryColor = Color(0xFF2196F3);
  static const Color accentColor = Color(0xFF03DAC6);

    static const LinearGradient darkBackgroundGradient = LinearGradient(
    begin: Alignment.topLeft,
    end: Alignment.bottomRight,
    colors: [
      Color(0xFF0F172A),       Color(0xFF1D2B64),       Color(0xFF283593),     ],
  );

    static const LinearGradient lightBackgroundGradient = LinearGradient(
    begin: Alignment.topLeft,
    end: Alignment.bottomRight,
    colors: [
      Color(0xFFE3F2FD),       Color(0xFFF3E5F5),       Color(0xFFFFFFFF),     ],
  );

    static const LinearGradient primaryBackgroundGradient =
      darkBackgroundGradient;

    static Widget glass({
    required Widget child,
    double borderRadius = 20,
    EdgeInsetsGeometry? padding,
    Color? color,
    BorderSide? border,
    VoidCallback? onTap,
  }) {
    final Color effectiveColor = color ?? Colors.white.withOpacity(0.07);
    final BorderSide effectiveBorder =
        border ?? BorderSide(color: Colors.white.withOpacity(0.18));
    final BorderRadius radius = BorderRadius.circular(borderRadius);

    Widget content = child;
    if (padding != null) {
      content = Padding(padding: padding, child: content);
    }

    if (onTap != null) {
      content = InkWell(
        onTap: onTap,
        borderRadius: radius,
        child: content,
      );
    }

    return ClipRRect(
      borderRadius: radius,
      child: BackdropFilter(
        filter: ImageFilter.blur(sigmaX: 16, sigmaY: 16),
        child: Material(
          color: effectiveColor,
          shape: RoundedRectangleBorder(
            borderRadius: radius,
            side: effectiveBorder,
          ),
          child: content,
        ),
      ),
    );
  }

  static final ThemeData lightTheme = ThemeData(
    useMaterial3: true,
    brightness: Brightness.light,
    colorScheme: ColorScheme.fromSeed(
      seedColor: primaryColor,
      brightness: Brightness.light,
    ),
    primaryColor: primaryColor,
    scaffoldBackgroundColor: Colors.transparent,
    canvasColor: Colors.transparent,
    appBarTheme: const AppBarTheme(
      backgroundColor: Colors.transparent,
      foregroundColor: Colors.black87,
      elevation: 0,
      centerTitle: false,
      systemOverlayStyle: SystemUiOverlayStyle(
        statusBarColor: Colors.transparent,
        statusBarIconBrightness: Brightness.dark,
        statusBarBrightness: Brightness.light,
      ),
    ),
    cardTheme: CardThemeData(
      color: Colors.white.withOpacity(0.5),
      elevation: 0,
      margin: EdgeInsets.zero,
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(20),
        side: BorderSide(color: Colors.black12),
      ),
    ),
    dialogTheme: DialogThemeData(
      backgroundColor: Colors.white.withOpacity(0.95),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(24),
        side: const BorderSide(color: Colors.black12),
      ),
    ),
    bottomSheetTheme: const BottomSheetThemeData(
      backgroundColor: Colors.white,
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.vertical(top: Radius.circular(24)),
      ),
    ),
    textTheme: const TextTheme(
      headlineLarge: TextStyle(
        color: Colors.black87,
        fontSize: 24,
        fontWeight: FontWeight.bold,
      ),
      headlineMedium: TextStyle(
        color: Colors.black87,
        fontSize: 20,
        fontWeight: FontWeight.w600,
      ),
      bodyLarge: TextStyle(
        color: Colors.black87,
        fontSize: 16,
      ),
      bodyMedium: TextStyle(
        color: Colors.black54,
        fontSize: 14,
      ),
    ),
    pageTransitionsTheme: const PageTransitionsTheme(
      builders: {
        TargetPlatform.android: FadeUpwardsPageTransitionsBuilder(),
        TargetPlatform.iOS: CupertinoPageTransitionsBuilder(),
        TargetPlatform.windows: FadeUpwardsPageTransitionsBuilder(),
        TargetPlatform.macOS: FadeUpwardsPageTransitionsBuilder(),
        TargetPlatform.linux: FadeUpwardsPageTransitionsBuilder(),
      },
    ),
  );

  static final ThemeData darkTheme = ThemeData(
    useMaterial3: true,
    brightness: Brightness.dark,
    colorScheme: ColorScheme.fromSeed(
      seedColor: primaryColor,
      brightness: Brightness.dark,
    ),
    primaryColor: primaryColor,
    scaffoldBackgroundColor: Colors.transparent,
    canvasColor: Colors.transparent,
    appBarTheme: const AppBarTheme(
      backgroundColor: Colors.transparent,
      foregroundColor: Colors.white,
      elevation: 0,
      centerTitle: false,
      systemOverlayStyle: SystemUiOverlayStyle(
        statusBarColor: Colors.transparent,
        statusBarIconBrightness: Brightness.light,
        statusBarBrightness: Brightness.dark,
      ),
    ),
    cardTheme: CardThemeData(
      color: Colors.white.withOpacity(0.08),
      elevation: 0,
      margin: EdgeInsets.zero,
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(20),
        side: BorderSide(color: Colors.white.withOpacity(0.18)),
      ),
    ),
    dialogTheme: DialogThemeData(
      backgroundColor: Colors.black.withOpacity(0.8),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(24),
        side: BorderSide(color: Colors.white.withOpacity(0.18)),
      ),
    ),
    bottomSheetTheme: BottomSheetThemeData(
      backgroundColor: Colors.black.withOpacity(0.9),
      shape: const RoundedRectangleBorder(
        borderRadius: BorderRadius.vertical(top: Radius.circular(24)),
      ),
    ),
    textTheme: const TextTheme(
      headlineLarge: TextStyle(
        color: Colors.white,
        fontSize: 24,
        fontWeight: FontWeight.bold,
      ),
      headlineMedium: TextStyle(
        color: Colors.white,
        fontSize: 20,
        fontWeight: FontWeight.w600,
      ),
      bodyLarge: TextStyle(
        color: Colors.white,
        fontSize: 16,
      ),
      bodyMedium: TextStyle(
        color: Colors.white70,
        fontSize: 14,
      ),
    ),
    pageTransitionsTheme: const PageTransitionsTheme(
      builders: {
        TargetPlatform.android: FadeUpwardsPageTransitionsBuilder(),
        TargetPlatform.iOS: CupertinoPageTransitionsBuilder(),
        TargetPlatform.windows: FadeUpwardsPageTransitionsBuilder(),
        TargetPlatform.macOS: FadeUpwardsPageTransitionsBuilder(),
        TargetPlatform.linux: FadeUpwardsPageTransitionsBuilder(),
      },
    ),
  );
}


================================================================================
